const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-BhmACnKF.js","assets/radix-vendor-Dhq5j3y7.js","assets/react-vendor-BWX1YzKK.js","assets/ui-vendor-UqaejbCm.js","assets/PostCard-CUBNtBjx.js","assets/label-a0evEz47.js","assets/supabase-vendor-F5gKsx73.js","assets/motion-vendor-BozBRtxF.js","assets/ProfilePage-BYukCCK3.js","assets/tabs-DUQzx2qO.js","assets/ConnectionsPage-Dr5coc1q.js","assets/SocietiesPage-DaAjOMou.js","assets/SocietyRoomPage-CDFGi7t4.js","assets/EventsPage-DdklcISJ.js","assets/ChatPage-ea9-m49N.js","assets/switch-DtIptJZc.js","assets/date-vendor-D2Wl-E30.js","assets/form-vendor-De9krBQK.js","assets/BookmarksPage-CUU3HAJx.js","assets/AdvancedSearchPage-B3WsnKx6.js","assets/SettingsPage-BWlN7tjh.js"])))=>i.map(i=>d[i]);
import{j as r,S as Ps,r as f,O as xt,b as Es,C as Cs,c as Ts,T as As,D as Rs,P as Ds,d as Is,e as Xr,f as Jr,g as Kr,h as Zr,I as Qr,V as ea,i as ta,k as sa,l as ra,m as aa,n as na,o as ia,p as oa,q as la,s as da,F as ca,t as ua,u as ma,v as ha,w as fa,x as pa,y as ga}from"./radix-vendor-Dhq5j3y7.js";import{a as xa}from"./react-vendor-BWX1YzKK.js";import{t as va,c as ya,a as Ms,C as ba,R as wa,b as we,L as Ls,X as vt,E as lt,d as dt,e as Os,f as xe,g as Vs,h as ja,i as Ct,A as Sa,j as Na,S as _a,H as Us,U as ka,G as Pa,k as Tt,l as Ea,m as Ca,n as Bs,o as zs,M as Fs,p as ct,q as At,B as Ta,r as Aa,s as Ra,u as Da,v as Ia,w as Ma,x as La,I as Oa,y as Va,z as Ua,P as Ba,T as za}from"./ui-vendor-UqaejbCm.js";import{c as Fa,_ as ee}from"./supabase-vendor-F5gKsx73.js";import{i as $s,f as ut,a as Hs,b as Be,c as $a,o as Ha,d as yt,e as Ga,g as Wa,h as bt,r as qa,s as Ya,t as Xa,j as G,k as Gs,l as Ws,m as Ja,n as Ka,p as Za,q as Qa,u as wt,v as qs,w as Ys,x as Rt,y as Xs,z as re,A as Y,B as Js,C as mt,D as en,E as tn,F as sn,G as U,H as ht,I as Ks,J as O,K as rn,L as an,M as nn,N as Dt,O as on,P as ze,Q as ve,R as Zs,S as It,T as ln,U as Qs,V as er,W as dn,X as Mt,Y as cn,Z as un,_ as mn,$ as hn,a0 as fn,a1 as qe,a2 as fe,a3 as De,a4 as Ie,a5 as Lt,a6 as pn,a7 as gn,a8 as xn,a9 as pe,aa as vn,ab as Ot,ac as yn,ad as bn,ae as tr,af as wn,ag as jn}from"./motion-vendor-BozBRtxF.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}})();var Me={},Vt;function Sn(){if(Vt)return Me;Vt=1;var e=xa();return Me.createRoot=e.createRoot,Me.hydrateRoot=e.hydrateRoot,Me}var Nn=Sn();function A(...e){return va(ya(e))}const _n=Ms("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:shadow-lg hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border-2 bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:shadow-md hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-5 py-2 has-[>svg]:px-4",sm:"h-9 rounded-lg gap-1.5 px-3.5 has-[>svg]:px-3",lg:"h-11 rounded-xl px-6 has-[>svg]:px-5",icon:"size-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}});function L({className:e,variant:t,size:s,asChild:a=!1,...n}){const l=a?Ps:"button";return r.jsx(l,{"data-slot":"button",className:A(_n({variant:t,size:s,className:e})),...n})}const kn=!1,ae="CampusLoif",ed="1.0.0",E={AUTH_TOKEN:"uniconnect_auth_token",USER_DATA:"uniconnect_user_data",DARK_MODE:"uniconnect_dark_mode",ONBOARDING_COMPLETE:"uniconnect_onboarding_complete",AUTH_PERSIST:"uniconnect_auth_persist",EMAIL_VERIFIED:"uniconnect_email_verified"},Pn={home:{id:"home",label:"Home Feed",icon:"🏠"},profile:{id:"profile",label:"My Profile",icon:"👤"},connections:{id:"connections",label:"Circle",icon:"👥"},societies:{id:"societies",label:"Societies",icon:"🎓"},"society-room":{id:"society-room",label:"Society Room",icon:"🏛️"},events:{id:"events",label:"Events",icon:"📅"},chat:{id:"chat",label:"Messages",icon:"💬"},bookmarks:{id:"bookmarks",label:"Bookmarks",icon:"🔖"},search:{id:"search",label:"Search",icon:"🔍"},settings:{id:"settings",label:"Settings",icon:"⚙️"}},En=["Computer Science","Business Administration","Engineering","Psychology","Biology","Mathematics","Economics","English Literature","Political Science","Arts & Design"],Cn=["Fall","Spring"],Tn=["2023","2024","2025","2026"],An=["Academic","Arts","Sports","Technology","Social","Cultural"],Q={MIN_PASSWORD_LENGTH:8,MAX_POST_LENGTH:500,MIN_BIO_LENGTH:10,MAX_BIO_LENGTH:160,ALLOWED_IMAGE_TYPES:["image/jpeg","image/png","image/webp"],MAX_IMAGE_SIZE_MB:5},le={NETWORK_ERROR:"Network error. Please check your connection.",AUTH_FAILED:"Authentication failed. Please try again.",INVALID_CREDENTIALS:"Invalid email or password.",SERVER_ERROR:"Server error. Please try again later.",UNAUTHORIZED:"You are not authorized to perform this action.",NOT_FOUND:"The requested resource was not found.",VALIDATION_ERROR:"Please check your input and try again."},Rn={LOGIN_SUCCESS:"Welcome back!",LOGOUT_SUCCESS:"Logged out successfully.",POST_CREATED:"Post created successfully!",CONNECTION_SENT:"Connection request sent!",CONNECTION_ACCEPTED:"Connection accepted!",SOCIETY_JOINED:"Successfully joined society!",EVENT_RSVP:"RSVP confirmed!"};class Dn extends f.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,s){console.error("Error caught by boundary:",t,s),this.setState({error:t,errorInfo:s})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:r.jsx("div",{className:"max-w-md w-full bg-card border border-border rounded-2xl p-8 shadow-lg",children:r.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[r.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center",children:r.jsx(ba,{className:"w-8 h-8 text-destructive"})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h2",{className:"text-xl",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"We're sorry, but something unexpected happened. Please try refreshing the page."})]}),kn,r.jsxs("div",{className:"flex gap-3 w-full mt-6",children:[r.jsx(L,{onClick:this.handleReset,variant:"outline",className:"flex-1 rounded-xl",children:"Try Again"}),r.jsxs(L,{onClick:()=>window.location.reload(),className:"flex-1 rounded-xl",children:[r.jsx(wa,{className:"w-4 h-4 mr-2"}),"Reload Page"]})]})]})})}):this.props.children}}const In="https://azhhescdfrayvrtxphtt.supabase.co",Mn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF6aGhlc2NkZnJheXZydHhwaHR0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3NDQzODcsImV4cCI6MjA3NTMyMDM4N30.TlZ1u2IJXbbRp226NGfb-kZwd1uDjG8_q42RpnkqEPo",_=Fa(In,Mn,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}}}),Ln=e=>new Promise(t=>setTimeout(t,e));class On{async login(t){let s=t.email.trim();if(!s.includes("@")){const{data:d,error:u}=await _.from("profiles").select("email").ilike("username",s).single();if(u||!d?.email)throw new Error(le.INVALID_CREDENTIALS);s=d.email}const{data:a,error:n}=await _.auth.signInWithPassword({email:s,password:t.password});if(n||!a.session||!a.user)throw new Error(le.INVALID_CREDENTIALS);const l=a.user,i=a.session.access_token,o=l.user_metadata?.name||l.user_metadata?.username||l.email?.split("@")[0]||"User",c={id:l.id,name:o,email:l.email||t.email,department:"",batch:"",bio:"",avatar:l.user_metadata?.avatar_url||"",connections:0,societies:0};try{const d=!!l.email_confirmed_at,u=localStorage;u.setItem(E.EMAIL_VERIFIED,d?"true":"false"),u.setItem(E.USER_DATA,JSON.stringify({email:c.email}))}catch{}return{user:c,token:i}}async signUp(t,s,a){const n=typeof window<"u"?`${window.location.origin}/verify`:void 0,{data:l,error:i}=await _.auth.signUp({email:t.trim(),password:s,options:{data:{username:a},emailRedirectTo:n}});if(i){let o=le.AUTH_FAILED;throw i.message.includes("User already registered")?o="An account with this email already exists. Please try logging in instead.":i.message.includes("invalid_redirect_url")?o="There was an issue with the email verification setup. Please try again later.":i.message.includes("Password should be at least")?o="Password does not meet requirements. Please ensure it has at least 8 characters, one uppercase letter, and one number.":i.message.includes("Invalid email")?o="Please enter a valid university email (.edu.pk domain).":o=i.message,new Error(o)}try{console.debug("[signUp]",{redirectTo:n,userId:l?.user?.id})}catch{}try{localStorage.setItem(E.EMAIL_VERIFIED,"false"),localStorage.setItem(E.USER_DATA,JSON.stringify({email:t}))}catch{}}async checkUsernameAvailability(t){const s=t.trim();if(!s||!/^[a-zA-Z0-9_]{3,20}$/.test(s))return!1;const{count:a,error:n}=await _.from("profiles").select("id",{count:"exact",head:!0}).ilike("username",s);return n?!1:(a??0)===0}async checkEmailAvailable(t){const s=t.trim().toLowerCase();if(!s||!s.endsWith(".edu.pk"))return!1;const{count:a,error:n}=await _.from("profiles").select("id",{count:"exact",head:!0}).ilike("email",s);return n?!0:(a??0)===0}async sendVerificationEmail(t){const{error:s}=await _.auth.resend({type:"signup",email:t.trim()});if(s)throw s}async logout(){await _.auth.signOut()}async completeOnboarding(t){const{data:s}=await _.auth.getUser(),a=s.user;if(!a||!a.email)throw new Error(le.UNAUTHORIZED);const n=(a.email.split("@")[1]||"").toLowerCase(),{data:l,error:i}=await _.from("university_domains").select("university_id").eq("domain",n).single();if(i||!l)throw new Error("Your email domain is not allowed.");const o=a.user_metadata?.name||a.user_metadata?.username||a.email.split("@")[0]||"User",c=`${t.session} ${t.year}`,{error:d}=await _.from("profiles").upsert({id:a.id,university_id:l.university_id,name:o,email:a.email,department:t.department,batch:c,username:a.user_metadata?.username||null},{onConflict:"id"});if(d)throw d;const u={id:a.id,name:o,email:a.email,department:t.department,batch:c,bio:"",avatar:a.user_metadata?.avatar_url||"",connections:0,societies:0};try{const m=localStorage;m.setItem(E.ONBOARDING_COMPLETE,"true"),m.setItem(E.USER_DATA,JSON.stringify(u))}catch{}return u}async updateProfile(t){await Ln(800);const s=(()=>{try{const l=sessionStorage.getItem("uniconnect_user_data");return l||localStorage.getItem("uniconnect_user_data")}catch{return null}})();if(!s)throw new Error(le.UNAUTHORIZED);return{...JSON.parse(s),...t}}async verifyToken(t){const{data:s}=await _.auth.getSession();return s.session?.access_token===t}async requestPasswordReset(t){const s=t.trim();if(!s.toLowerCase().endsWith(".edu.pk"))throw new Error("Please use your official .edu.pk university email address");const a=typeof window<"u"?`${window.location.origin}/reset`:void 0,{error:n}=await _.auth.resetPasswordForEmail(s,{redirectTo:a});if(n){let l=le.AUTH_FAILED;throw n.message.includes("User not found")?l="No account found with this email address.":n.message.includes("Email rate limit exceeded")?l="Too many reset requests. Please wait a few minutes before trying again.":l=n.message,new Error(l)}}}const ne=new On,sr=f.createContext(void 0);function Vn({children:e}){const[t,s]=f.useState({isAuthenticated:!1,isEmailVerified:!1,isOnboarded:!1,user:null,isLoading:!0,error:null}),a=m=>{try{const h=typeof window<"u"?sessionStorage.getItem(m):null;return h||(typeof window<"u"?localStorage.getItem(m):null)}catch{return null}},n=()=>{try{return typeof window>"u"?localStorage:!!sessionStorage.getItem(E.AUTH_TOKEN)?sessionStorage:localStorage}catch{return localStorage}};f.useEffect(()=>{(async()=>{try{const{data:p}=await _.auth.getSession(),x=p.session,y=a(E.ONBOARDING_COMPLETE)==="true";if(x?.user){const v=x.user,g=v.user_metadata?.name||v.user_metadata?.username||v.email?.split("@")[0]||"User",b={id:v.id,name:g,email:v.email||"",department:"",batch:"",bio:"",avatar:v.user_metadata?.avatar_url||"",connections:0,societies:0};s({isAuthenticated:!0,isEmailVerified:!!v.email_confirmed_at,isOnboarded:y,user:b,isLoading:!1,error:null})}else{const v=a(E.USER_DATA),g=a(E.EMAIL_VERIFIED)==="true";if(v){const b=JSON.parse(v);s({isAuthenticated:!1,isEmailVerified:g,isOnboarded:y,user:b,isLoading:!1,error:null})}else s(b=>({...b,isLoading:!1}))}}catch(p){console.error("Failed to initialize auth:",p),s(x=>({...x,isLoading:!1}))}})();const{data:h}=_.auth.onAuthStateChange((p,x)=>{const y=x?.user;if(y){const v=y.user_metadata?.name||y.user_metadata?.username||y.email?.split("@")[0]||"User",g={id:y.id,name:v,email:y.email||"",department:"",batch:"",bio:"",avatar:y.user_metadata?.avatar_url||"",connections:0,societies:0},b=a(E.ONBOARDING_COMPLETE)==="true";s(w=>({...w,isAuthenticated:!0,isEmailVerified:!!y.email_confirmed_at,isOnboarded:b,user:g}))}else s(v=>({...v,isAuthenticated:!1,isEmailVerified:!1,isOnboarded:!1,user:null}))});return()=>{h.subscription.unsubscribe()}},[]);const u={...t,login:async m=>{s(h=>({...h,isLoading:!0,error:null}));try{const{user:h,token:p}=await ne.login(m),x=(typeof window<"u"?localStorage.getItem(E.AUTH_PERSIST):null)||"local",y=x==="session"?sessionStorage:localStorage;try{const w=x==="session"?localStorage:sessionStorage;w.removeItem(E.AUTH_TOKEN),w.removeItem(E.USER_DATA),w.removeItem(E.ONBOARDING_COMPLETE)}catch(w){console.error("Failed to clear persisted auth data:",w)}y.setItem(E.AUTH_TOKEN,p),y.setItem(E.USER_DATA,JSON.stringify(h));const{data:v}=await _.auth.getSession(),g=!!v.session?.user?.email_confirmed_at,b=a(E.ONBOARDING_COMPLETE)==="true";s({isAuthenticated:!0,isEmailVerified:g,isOnboarded:b,user:h,isLoading:!1,error:null})}catch(h){throw s(p=>({...p,isLoading:!1,error:h instanceof Error?h.message:"Login failed"})),h}},signup:async m=>{s(h=>({...h,isLoading:!0,error:null}));try{await ne.signUp(m.email,m.password,m.username);const h={id:"",name:m.username||m.email.split("@")[0],email:m.email,department:"",batch:"",bio:"",avatar:"",connections:0,societies:0};try{localStorage.setItem(E.USER_DATA,JSON.stringify(h)),localStorage.setItem(E.EMAIL_VERIFIED,"false")}catch{}s({isAuthenticated:!1,isEmailVerified:!1,isOnboarded:!1,user:h,isLoading:!1,error:null})}catch(h){let p="Signup failed. Please try again.";throw h instanceof Error&&(h.message.includes("network")||h.message.includes("fetch")?p="Network error. Please check your connection and try again.":p=h.message),s(x=>({...x,isLoading:!1,error:p})),h}},logout:async()=>{s(m=>({...m,isLoading:!0}));try{await ne.logout();try{localStorage.removeItem(E.AUTH_TOKEN),localStorage.removeItem(E.USER_DATA),localStorage.removeItem(E.ONBOARDING_COMPLETE),sessionStorage.removeItem(E.AUTH_TOKEN),sessionStorage.removeItem(E.USER_DATA),sessionStorage.removeItem(E.ONBOARDING_COMPLETE)}catch(m){console.error("Failed to clear auth storage during logout:",m)}s({isAuthenticated:!1,isEmailVerified:!1,isOnboarded:!1,user:null,isLoading:!1,error:null})}catch(m){console.error("Logout error:",m),s(h=>({...h,isLoading:!1}))}},completeOnboarding:async m=>{s(h=>({...h,isLoading:!0,error:null}));try{const h=await ne.completeOnboarding(m),p=n();p.setItem(E.ONBOARDING_COMPLETE,"true"),p.setItem(E.USER_DATA,JSON.stringify(h)),s(x=>({...x,isOnboarded:!0,user:h,isLoading:!1}))}catch(h){throw s(p=>({...p,isLoading:!1,error:h instanceof Error?h.message:"Onboarding failed"})),h}},updateUser:m=>{if(!t.user)return;const h={...t.user,...m};n().setItem(E.USER_DATA,JSON.stringify(h)),s(x=>({...x,user:h}))}};return r.jsx(sr.Provider,{value:u,children:e})}function he(){const e=f.useContext(sr);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const rr=f.createContext(void 0);function Un({children:e}){const[t,s]=f.useState({currentPage:"home",darkMode:!1,isLoading:!1,error:null,notifications:[],unreadNotifications:0});f.useEffect(()=>{const c=localStorage.getItem(E.DARK_MODE);if(c!==null){const d=c==="true";s(u=>({...u,darkMode:d}))}},[]),f.useEffect(()=>{t.darkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem(E.DARK_MODE,String(t.darkMode))},[t.darkMode]);const o={...t,navigate:(c,d)=>{s(u=>({...u,currentPage:c,error:null,currentSocietyId:d}))},toggleDarkMode:()=>{s(c=>({...c,darkMode:!c.darkMode}))},setLoading:c=>{s(d=>({...d,isLoading:c}))},setError:c=>{s(d=>({...d,error:c}))}};return r.jsx(rr.Provider,{value:o,children:e})}function Te(){const e=f.useContext(rr);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}const ar=f.createContext(void 0),Bn=[{id:"1",type:"connection_request",title:"New Connection Request",message:"Sarah Chen wants to connect with you",avatar:void 0,timestamp:"2m ago",read:!1},{id:"2",type:"post_reaction",title:"Michael loved your post",message:"Your post about the hackathon received a new reaction",timestamp:"1h ago",read:!1},{id:"3",type:"event_reminder",title:"Event Tomorrow",message:"Tech Talk: AI & Ethics starts at 5 PM",timestamp:"3h ago",read:!1}];function zn({children:e}){const[t,s]=f.useState(Bn),a=t.filter(d=>!d.read).length,n=d=>{const u={...d,id:Date.now().toString(),timestamp:"Just now"};s(m=>[u,...m])},l=d=>{s(u=>u.map(m=>m.id===d?{...m,read:!0}:m))},i=()=>{s(d=>d.map(u=>({...u,read:!0})))},o=d=>{s(u=>u.filter(m=>m.id!==d))},c=()=>{s([])};return r.jsx(ar.Provider,{value:{notifications:t,unreadCount:a,addNotification:n,markAsRead:l,markAllAsRead:i,clearNotification:o,clearAll:c},children:e})}function nr(){const e=f.useContext(ar);if(!e)throw new Error("useNotifications must be used within NotificationProvider");return e}const ir=f.createContext(void 0),Fn=[{userId:"user1",userName:"Sarah Johnson",userAvatar:void 0,hasUnviewed:!0,latestStoryTime:"2h ago",stories:[{id:"story1",userId:"user1",userName:"Sarah Johnson",userAvatar:void 0,department:"Computer Science",content:"Working on my ML project! 🚀",mediaUrl:"https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=400",mediaType:"image",createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+1440*60*1e3).toISOString(),views:45,viewedBy:[]}]},{userId:"user2",userName:"Michael Chen",userAvatar:void 0,hasUnviewed:!0,latestStoryTime:"4h ago",stories:[{id:"story2",userId:"user2",userName:"Michael Chen",userAvatar:void 0,department:"Business",content:"Great marketing event today!",backgroundColor:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",createdAt:new Date(Date.now()-14400*1e3).toISOString(),expiresAt:new Date(Date.now()+1200*60*1e3).toISOString(),views:32,viewedBy:[]}]},{userId:"user3",userName:"Emily Rodriguez",userAvatar:void 0,hasUnviewed:!1,latestStoryTime:"6h ago",stories:[{id:"story3",userId:"user3",userName:"Emily Rodriguez",userAvatar:void 0,department:"Psychology",content:"Study session vibes ✨",mediaUrl:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400",mediaType:"image",createdAt:new Date(Date.now()-360*60*1e3).toISOString(),expiresAt:new Date(Date.now()+1080*60*1e3).toISOString(),views:78,viewedBy:["currentUser"]}]}];function $n({children:e}){const[t,s]=f.useState(Fn),a=i=>{const o={...i,id:`story-${Date.now()}`,createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+864e5).toISOString(),views:0,viewedBy:[]};s(c=>{const d=c.findIndex(u=>u.userId===i.userId);if(d!==-1){const u=[...c];return u[d]={...u[d],stories:[o,...u[d].stories],latestStoryTime:"Just now"},u}else return[{userId:i.userId,userName:i.userName,userAvatar:i.userAvatar,hasUnviewed:!0,latestStoryTime:"Just now",stories:[o]},...c]})},n=(i,o)=>{s(c=>c.map(d=>({...d,stories:d.stories.map(u=>u.id===i?{...u,views:u.views+1,viewedBy:[...u.viewedBy,o]}:u),hasUnviewed:d.userId===o?!1:d.hasUnviewed})))},l=i=>{s(o=>o.map(c=>({...c,stories:c.stories.filter(d=>d.id!==i)})).filter(c=>c.stories.length>0))};return r.jsx(ir.Provider,{value:{storyGroups:t,addStory:a,viewStory:n,deleteStory:l},children:e})}function td(){const e=f.useContext(ir);if(!e)throw new Error("useStories must be used within StoryProvider");return e}class Hn{typingUsers=new Map;typingTimeouts=new Map;async getRooms(){try{const{data:t,error:s}=await _.from("rooms").select(`
          id, room_type, university_id, society_id, name, avatar_url, created_by, last_message_at, created_at,
          room_members!inner(
            user_id,
            role,
            last_read_at,
            joined_at,
            profiles:profiles!room_members_user_id_fkey(
              name,
              avatar_url,
              is_online
            )
          )
        `).order("last_message_at",{ascending:!1});if(!s&&t)return t.map(u=>({id:u.id,room_type:u.room_type,name:u.name,avatar_url:u.avatar_url,university_id:u.university_id,society_id:u.society_id,created_by:u.created_by,last_message_at:u.last_message_at||"",created_at:u.created_at||"",members:(u.room_members||[]).map(m=>({user_id:m.user_id,name:m.profiles?.name,avatar_url:m.profiles?.avatar_url,role:m.role,last_read_at:m.last_read_at,joined_at:m.joined_at,is_online:!!m.profiles?.is_online})),unread_count:0,unreadCount:0,is_typing:[]}));const a=(await _.auth.getUser()).data.user;if(!a)return[];const{data:n,error:l}=await _.from("room_members").select("room_id").eq("user_id",a.id);if(l||!n||n.length===0)return[];const i=n.map(u=>u.room_id),{data:o,error:c}=await _.from("rooms").select("id, room_type, university_id, society_id, name, avatar_url, created_by, last_message_at, created_at").in("id",i).order("last_message_at",{ascending:!1});return c||!o?[]:await Promise.all(o.map(async u=>{const{data:m}=await _.from("room_members").select("user_id, role, last_read_at, joined_at, profiles(name, avatar_url, is_online)").eq("room_id",u.id);return{id:u.id,room_type:u.room_type,name:u.name,avatar_url:u.avatar_url,university_id:u.university_id,society_id:u.society_id,created_by:u.created_by,last_message_at:u.last_message_at||"",created_at:u.created_at||"",members:(m||[]).map(h=>({user_id:h.user_id,name:h.profiles?.name,avatar_url:h.profiles?.avatar_url,role:h.role,last_read_at:h.last_read_at,joined_at:h.joined_at,is_online:!!h.profiles?.is_online})),unread_count:0,unreadCount:0,is_typing:[]}}))}catch(t){throw console.error("Error fetching rooms:",t?.message||t,t?.details||""),new Error("Failed to fetch chat rooms")}}async createRoom(t){try{if(t.room_type==="dm"&&t.member_ids.length===2){const o=await this.findDMRoom(t.member_ids[0],t.member_ids[1]);if(o)return o}const{data:s,error:a}=await _.from("rooms").insert({room_type:t.room_type,name:t.name,society_id:t.society_id,created_by:(await _.auth.getUser()).data.user?.id}).select().single();if(a)throw a;const n=t.member_ids.map(o=>({room_id:s.id,user_id:o,role:"member"})),{error:l}=await _.from("room_members").insert(n);if(l)throw l;return await this.getRoomById(s.id)}catch(s){throw console.error("Error creating room:",s),new Error("Failed to create chat room")}}async getRoomById(t){try{const{data:s,error:a}=await _.from("rooms").select(`
          *,
          room_members!inner(
            user_id,
            role,
            last_read_at,
            joined_at,
            profiles!inner(
              name,
              avatar_url,
              is_online
            )
          )
        `).eq("id",t).single();if(a)throw a;return{id:s.id,room_type:s.room_type,name:s.name,avatar_url:s.avatar_url,university_id:s.university_id,society_id:s.society_id,created_by:s.created_by,last_message_at:s.last_message_at||"",created_at:s.created_at||"",members:s.room_members.map(n=>({user_id:n.user_id,name:n.profiles.name,avatar_url:n.profiles.avatar_url,role:n.role,last_read_at:n.last_read_at,joined_at:n.joined_at,is_online:n.profiles.is_online})),unread_count:0,unreadCount:0,is_typing:[]}}catch(s){throw console.error("Error fetching room:",s),new Error("Failed to fetch chat room")}}async findDMRoom(t,s){try{const{data:a,error:n}=await _.from("rooms").select(`
          *,
          room_members!inner(
            user_id,
            role,
            last_read_at,
            joined_at,
            profiles!inner(
              name,
              avatar_url,
              is_online
            )
          )
        `).eq("room_type","dm").or(`and(user_id.eq.${t},user_id.eq.${s}),and(user_id.eq.${s},user_id.eq.${t})`);if(n)throw n;const l=a.find(i=>i.room_members.some(o=>o.user_id===t)&&i.room_members.some(o=>o.user_id===s));return l?{id:l.id,room_type:l.room_type,name:l.name,avatar_url:l.avatar_url,university_id:l.university_id,society_id:l.society_id,created_by:l.created_by,last_message_at:l.last_message_at,created_at:l.created_at,members:l.room_members.map(i=>({user_id:i.user_id,name:i.profiles.name,avatar_url:i.profiles.avatar_url,role:i.role,last_read_at:i.last_read_at,joined_at:i.joined_at,is_online:i.profiles.is_online})),unread_count:0,is_typing:[]}:null}catch(a){return console.error("Error finding DM room:",a),null}}async getMessages(t,s=50,a=0){try{const{data:n,error:l}=await _.from("messages").select(`
          *,
          profiles!inner(
            name,
            avatar_url
          ),
          message_reactions(
            emoji,
            user_id
          )
        `).eq("room_id",t).order("created_at",{ascending:!1}).range(a,a+s-1);if(l)throw l;return n.map(i=>({id:i.id,room_id:i.room_id,author_id:i.author_id,author_name:i.profiles.name,author_avatar:i.profiles.avatar_url,body:i.body,attachments:i.attachments||[],reactions:this.groupReactions(i.message_reactions||[]),reply_to:i.reply_to,edited_at:i.edited_at,created_at:i.created_at,is_edited:!!i.edited_at,is_deleted:!1})).reverse()}catch(n){throw console.error("Error fetching messages:",n),new Error("Failed to fetch messages")}}async sendMessage(t){try{const s=(await _.auth.getUser()).data.user;if(!s)throw new Error("User not authenticated");let a=[];t.attachments&&t.attachments.length>0&&(a=await this.uploadAttachments(t.attachments));const{data:n,error:l}=await _.from("messages").insert({room_id:t.room_id,author_id:s.id,body:t.body,attachments:a,reply_to:t.reply_to}).select(`
          *,
          profiles!inner(
            name,
            avatar_url
          )
        `).single();if(l)throw l;return await _.from("rooms").update({last_message_at:n.created_at}).eq("id",t.room_id),{id:n.id,room_id:n.room_id,author_id:n.author_id,author_name:n.profiles.name,author_avatar:n.profiles.avatar_url,body:n.body,attachments:n.attachments||[],reactions:[],reply_to:n.reply_to,edited_at:n.edited_at,created_at:n.created_at,is_edited:!1,is_deleted:!1}}catch(s){throw console.error("Error sending message:",s),new Error("Failed to send message")}}async editMessage(t,s){try{const{error:a}=await _.from("messages").update({body:s,edited_at:new Date().toISOString()}).eq("id",t);if(a)throw a}catch(a){throw console.error("Error editing message:",a),new Error("Failed to edit message")}}async deleteMessage(t){try{const{error:s}=await _.from("messages").delete().eq("id",t);if(s)throw s}catch(s){throw console.error("Error deleting message:",s),new Error("Failed to delete message")}}async addReaction(t,s){try{const a=(await _.auth.getUser()).data.user;if(!a)throw new Error("User not authenticated");const{error:n}=await _.from("message_reactions").upsert({message_id:t,user_id:a.id,emoji:s});if(n)throw n}catch(a){throw console.error("Error adding reaction:",a),new Error("Failed to add reaction")}}async removeReaction(t,s){try{const a=(await _.auth.getUser()).data.user;if(!a)throw new Error("User not authenticated");const{error:n}=await _.from("message_reactions").delete().eq("message_id",t).eq("user_id",a.id).eq("emoji",s);if(n)throw n}catch(a){throw console.error("Error removing reaction:",a),new Error("Failed to remove reaction")}}async startTyping(t){try{const s=(await _.auth.getUser()).data.user;if(!s)throw new Error("User not authenticated");const a={user_id:s.id,user_name:s.user_metadata?.name||"Unknown",timestamp:Date.now()},n=this.typingTimeouts.get(s.id);n&&clearTimeout(n);const l=setTimeout(()=>{this.stopTyping(t)},3e3);this.typingTimeouts.set(s.id,l),this.typingUsers.has(t)||this.typingUsers.set(t,new Map),this.typingUsers.get(t).set(s.id,a),this.broadcastTypingStatus(t)}catch(s){console.error("Error starting typing:",s)}}async stopTyping(t){try{const s=(await _.auth.getUser()).data.user;if(!s)return;const a=this.typingTimeouts.get(s.id);a&&(clearTimeout(a),this.typingTimeouts.delete(s.id));const n=this.typingUsers.get(t);n&&(n.delete(s.id),n.size===0&&this.typingUsers.delete(t)),this.broadcastTypingStatus(t)}catch(s){console.error("Error stopping typing:",s)}}async markAsRead(t){try{const s=(await _.auth.getUser()).data.user;if(!s)throw new Error("User not authenticated");const{error:a}=await _.from("room_members").update({last_read_at:new Date().toISOString()}).eq("room_id",t).eq("user_id",s.id);if(a)throw a}catch(s){throw console.error("Error marking as read:",s),new Error("Failed to mark as read")}}async searchMessages(t,s){try{let a=_.from("messages").select(`
          *,
          profiles!inner(
            name,
            avatar_url
          ),
          message_reactions(
            emoji,
            user_id
          )
        `).textSearch("body",t);s&&(a=a.eq("room_id",s));const{data:n,error:l}=await a.order("created_at",{ascending:!1}).limit(50);if(l)throw l;return n.map(i=>({id:i.id,room_id:i.room_id,author_id:i.author_id,author_name:i.profiles.name,author_avatar:i.profiles.avatar_url,body:i.body,attachments:i.attachments||[],reactions:this.groupReactions(i.message_reactions||[]),reply_to:i.reply_to,edited_at:i.edited_at,created_at:i.created_at,is_edited:!!i.edited_at,is_deleted:!1}))}catch(a){throw console.error("Error searching messages:",a),new Error("Failed to search messages")}}subscribeToMessages(t,s){return _.channel(`room:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`room_id=eq.${t}`},async a=>{const n=a.new,{data:l}=await _.from("messages").select(`
              *,
              profiles!inner(
                name,
                avatar_url
              ),
              message_reactions(
                emoji,
                user_id
              )
            `).eq("id",n.id).single();if(l){const i={id:l.id,room_id:l.room_id,author_id:l.author_id,author_name:l.profiles.name,author_avatar:l.profiles.avatar_url,body:l.body,attachments:l.attachments||[],reactions:this.groupReactions(l.message_reactions||[]),reply_to:l.reply_to,edited_at:l.edited_at,created_at:l.created_at,is_edited:!!l.edited_at,is_deleted:!1};s(i)}}).subscribe()}subscribeToTyping(t,s){const a=setInterval(()=>{const n=this.typingUsers.get(t);if(n){const l=Array.from(n.values()).filter(i=>Date.now()-i.timestamp<5e3);s(l)}},1e3);return()=>clearInterval(a)}groupReactions(t){const s=t.reduce((a,n)=>(a[n.emoji]||(a[n.emoji]={emoji:n.emoji,users:[],count:0}),a[n.emoji].users.push(n.user_id),a[n.emoji].count++,a),{});return Object.values(s)}async uploadAttachments(t){const s=[];for(const a of t)try{const n=a.name.split(".").pop(),i=`chat-attachments/${`${Date.now()}-${Math.random().toString(36).substring(2)}.${n}`}`,{data:o,error:c}=await _.storage.from("chat-attachments").upload(i,a);if(c)throw c;const{data:{publicUrl:d}}=_.storage.from("chat-attachments").getPublicUrl(i);s.push({id:o.path,type:this.getFileType(a.type),url:d,filename:a.name,size:a.size,metadata:{mimeType:a.type}})}catch(n){console.error("Error uploading file:",n)}return s}getFileType(t){return t.startsWith("image/")?"image":t.startsWith("video/")?"video":t.startsWith("audio/")?"audio":"file"}broadcastTypingStatus(t){const s=new CustomEvent("typingStatusChanged",{detail:{roomId:t,typingUsers:Array.from(this.typingUsers.get(t)?.values()||[])}});window.dispatchEvent(s)}}const q=new Hn,or=f.createContext(void 0);function Gn({children:e}){const{user:t}=he(),[s,a]=f.useState([]),[n,l]=f.useState(null),[i,o]=f.useState([]),[c,d]=f.useState([]),[u,m]=f.useState(!1),[h,p]=f.useState(null),[x,y]=f.useState(""),[v,g]=f.useState([]),b=f.useRef(null),w=f.useRef(null),k=f.useRef(null),C=f.useCallback(()=>{b.current&&(b.current.unsubscribe(),b.current=null),w.current&&(w.current(),w.current=null)},[]),I=f.useCallback(async()=>{if(n)try{await q.markAsRead(n.id),a(P=>P.map(S=>S.id===n.id?{...S,unreadCount:0}:S))}catch(P){console.error("Failed to mark as read:",P)}},[n]),F=f.useCallback(P=>{b.current=q.subscribeToMessages(P,S=>{o(D=>[...D,S]),n?.id===P&&I()}),w.current=q.subscribeToTyping(P,S=>{d(S)})},[n,I]),H=f.useCallback(async()=>{try{m(!0),p(null);const P=await q.getRooms();a(P)}catch(P){p(P instanceof Error?P.message:"Failed to load chat rooms")}finally{m(!1)}},[]),W=f.useCallback(async P=>{try{m(!0),p(null);const S=await q.getMessages(P);o(S)}catch(S){p(S instanceof Error?S.message:"Failed to load messages")}finally{m(!1)}},[]),N=f.useCallback(async P=>{try{p(null);const S=await q.sendMessage(P);o(D=>[...D,S])}catch(S){throw p(S instanceof Error?S.message:"Failed to send message"),S}},[]),T=f.useCallback(async P=>{try{p(null);const S=await q.createRoom(P);return a(D=>[S,...D]),S}catch(S){throw p(S instanceof Error?S.message:"Failed to create room"),S}},[]),j=f.useCallback(async(P,S)=>{try{p(null),await q.editMessage(P,S),o(D=>D.map($=>$.id===P?{...$,content:S,isEdited:!0,editedAt:new Date().toISOString()}:$))}catch(D){throw p(D instanceof Error?D.message:"Failed to edit message"),D}},[]),M=f.useCallback(async P=>{try{p(null),await q.deleteMessage(P),o(S=>S.filter(D=>D.id!==P))}catch(S){throw p(S instanceof Error?S.message:"Failed to delete message"),S}},[]),B=f.useCallback(async(P,S)=>{try{p(null),await q.addReaction(P,S),o(D=>D.map($=>$.id===P?$.reactions.find(se=>se.emoji===S)?{...$,reactions:$.reactions.map(se=>se.emoji===S?{...se,count:se.count+1,users:[...se.users,t?.id||""]}:se)}:{...$,reactions:[...$.reactions,{emoji:S,users:[t?.id||""],count:1}]}:$))}catch(D){throw p(D instanceof Error?D.message:"Failed to add reaction"),D}},[t]),te=f.useCallback(async(P,S)=>{try{p(null),await q.removeReaction(P,S),o(D=>D.map($=>$.id===P?{...$,reactions:$.reactions.map(oe=>oe.emoji===S?{...oe,count:Math.max(0,oe.count-1),users:oe.users.filter(se=>se!==t?.id)}:oe).filter(oe=>oe.count>0)}:$))}catch(D){throw p(D instanceof Error?D.message:"Failed to remove reaction"),D}},[t]),V=f.useCallback(()=>{n&&(k.current&&(clearTimeout(k.current),k.current=null),q.stopTyping(n.id))},[n]),R=f.useCallback(()=>{n&&(k.current&&clearTimeout(k.current),q.startTyping(n.id),k.current=setTimeout(()=>{V()},3e3))},[n,V]),Z=f.useCallback(async P=>{try{if(p(null),y(P),P.trim()){const S=await q.searchMessages(P,n?.id);g(S)}else g([])}catch(S){p(S instanceof Error?S.message:"Failed to search messages")}},[n]),ye=f.useCallback(()=>{y(""),g([])},[]),be=f.useCallback(async()=>{n&&await W(n.id)},[n,W]),qr=f.useCallback(async P=>{l(P),P?(await W(P.id),await I()):o([])},[W,I]);f.useEffect(()=>{t&&H()},[t,H]),f.useEffect(()=>(n?F(n.id):C(),()=>{C()}),[n,F,C]),f.useEffect(()=>{const P=S=>{n&&S.detail.roomId===n.id&&d(S.detail.typingUsers)};return window.addEventListener("typingStatusChanged",P),()=>{window.removeEventListener("typingStatusChanged",P)}},[n]);const Yr={rooms:s,currentRoom:n,messages:i,typingUsers:c,isLoading:u,error:h,searchQuery:x,searchResults:v,setCurrentRoom:qr,loadRooms:H,loadMessages:W,sendMessage:N,createRoom:T,editMessage:j,deleteMessage:M,addReaction:B,removeReaction:te,startTyping:R,stopTyping:V,markAsRead:I,searchMessages:Z,clearSearch:ye,refreshMessages:be};return r.jsx(or.Provider,{value:Yr,children:e})}function sd(){const e=f.useContext(or);if(e===void 0)throw new Error("useChat must be used within a ChatProvider");return e}function ie({className:e,type:t,...s}){return r.jsx("input",{type:t,"data-slot":"input",className:A("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-11 w-full min-w-0 rounded-2xl border-2 px-4 py-2 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-8 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}function Ae(){return{success:l=>{we.success(l)},error:l=>{we.error(l)},info:l=>{we.info(l)},loading:l=>we.loading(l),dismiss:l=>{we.dismiss(l)},messages:{success:Rn,error:le}}}const z={email:e=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,s=e.split("@")[1]||"";return e.trim()?t.test(e)?/\.edu\.pk$/i.test(s)?{valid:!0}:{valid:!1,message:"Must be .edu.pk email"}:{valid:!1,message:"Invalid email format"}:{valid:!1,message:"Email required!"}},username:e=>e.trim()?e.length<3?{valid:!1,message:"Too short (min 3 chars)"}:e.length>20?{valid:!1,message:"Too long (max 20 chars)"}:/^[a-zA-Z0-9_]+$/.test(e)?{valid:!0}:{valid:!1,message:"Only letters, numbers, underscores"}:{valid:!1,message:"Username required!"},password:e=>e?e.length<Q.MIN_PASSWORD_LENGTH?{valid:!1,message:`Too short (min ${Q.MIN_PASSWORD_LENGTH} chars)`}:/[A-Z]/.test(e)?/[0-9]/.test(e)?{valid:!0}:{valid:!1,message:"Needs a number"}:{valid:!1,message:"Needs uppercase letter"}:{valid:!1,message:"Password required!"},postContent:e=>e.trim()?e.length>Q.MAX_POST_LENGTH?{valid:!1,message:`Post cannot exceed ${Q.MAX_POST_LENGTH} characters`}:{valid:!0}:{valid:!1,message:"Post content cannot be empty"},bio:e=>e.length<Q.MIN_BIO_LENGTH?{valid:!1,message:`Bio must be at least ${Q.MIN_BIO_LENGTH} characters`}:e.length>Q.MAX_BIO_LENGTH?{valid:!1,message:`Bio cannot exceed ${Q.MAX_BIO_LENGTH} characters`}:{valid:!0},imageFile:e=>{const t=(e.type||"").toLowerCase(),s=Q.ALLOWED_IMAGE_TYPES.map(c=>c.toLowerCase()),a=e.name.split(".").pop()?.toLowerCase(),n=["jpg","jpeg","png","webp"],l=t?s.includes(t):!1,i=a?n.includes(a):!1;return!l&&!i?{valid:!1,message:"Please upload a JPEG, PNG, or WebP image"}:e.size/(1024*1024)>Q.MAX_IMAGE_SIZE_MB?{valid:!1,message:`Image size must be less than ${Q.MAX_IMAGE_SIZE_MB}MB`}:{valid:!0}}};function me({size:e="md",fullScreen:t=!1,text:s}){const a={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"},n=r.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[r.jsx(Ls,{className:`${a[e]} animate-spin text-primary`}),s&&r.jsx("p",{className:"text-sm text-muted-foreground",children:s})]});return t?r.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:n}):n}function lr({...e}){return r.jsx(Es,{"data-slot":"dialog",...e})}function Wn({...e}){return r.jsx(Is,{"data-slot":"dialog-trigger",...e})}function qn({...e}){return r.jsx(Ds,{"data-slot":"dialog-portal",...e})}const dr=f.forwardRef(({className:e,...t},s)=>r.jsx(xt,{ref:s,"data-slot":"dialog-overlay",className:A("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t}));dr.displayName=xt.displayName;function cr({className:e,children:t,...s}){return r.jsxs(qn,{"data-slot":"dialog-portal",children:[r.jsx(dr,{}),r.jsxs(Cs,{"data-slot":"dialog-content",className:A("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border-2 p-6 shadow-2xl duration-200 sm:max-w-lg",e),...s,children:[t,r.jsxs(Ts,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[r.jsx(vt,{}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ur({className:e,...t}){return r.jsx("div",{"data-slot":"dialog-header",className:A("flex flex-col gap-2 text-center sm:text-left",e),...t})}function Yn({className:e,...t}){return r.jsx("div",{"data-slot":"dialog-footer",className:A("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function mr({className:e,...t}){return r.jsx(As,{"data-slot":"dialog-title",className:A("text-lg leading-none font-semibold",e),...t})}function hr({className:e,...t}){return r.jsx(Rs,{"data-slot":"dialog-description",className:A("text-muted-foreground text-sm",e),...t})}function Xn(){const[e,t]=f.useState(""),[s,a]=f.useState(""),[n,l]=f.useState({identifier:"",password:"",login:""}),[i,o]=f.useState({identifier:"",password:""}),{login:c,isLoading:d}=he(),u=Ae(),[m,h]=f.useState(!1),[p,x]=f.useState(!0),[y,v]=f.useState(!1),[g,b]=f.useState(""),[w,k]=f.useState(""),[C,I]=f.useState(!1),[F,H]=f.useState(!1),W=j=>{if(t(j),!j.trim()){o(B=>({...B,identifier:""}));return}if(j.includes("@")){const B=z.email(j);o(te=>({...te,identifier:B.valid?"":B.message||""}))}else{const B=z.username(j);o(te=>({...te,identifier:B.valid?"":B.message||""}))}},N=j=>{if(a(j),!j){o(B=>({...B,password:""}));return}const M=z.password(j);o(B=>({...B,password:M.valid?"":M.message||""}))},T=async j=>{j.preventDefault();const M={identifier:"",password:"",login:""};if(e.includes("@")){const V=z.email(e);V.valid||(M.identifier=V.message||"Invalid email")}else{const V=z.username(e);V.valid||(M.identifier=V.message||"Invalid username")}const te=z.password(s);if(te.valid||(M.password=te.message||"Invalid password"),M.identifier||M.password){l(M);return}l({identifier:"",password:"",login:""});try{localStorage.setItem(E.AUTH_PERSIST,p?"local":"session")}catch(V){console.error("Failed to persist auth preference:",V)}try{await c({email:e,password:s}),u.success(u.messages.success.LOGIN_SUCCESS)}catch(V){V instanceof Error?V.message.includes("network")||V.message.includes("fetch")||V.message==="Failed to fetch"?l(R=>({...R,login:"Network error. Please check your connection and try again."})):V.message===le.INVALID_CREDENTIALS?l(R=>({...R,login:"Email or password is incorrect!"})):l(R=>({...R,login:"Login failed. Please try again."})):l(R=>({...R,login:"An unexpected error occurred."}))}};return d?r.jsx(me,{fullScreen:!0,size:"lg",text:"Signing in..."}):r.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/15 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"w-full max-w-md relative z-10",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-4xl font-brand text-primary mb-3",children:ae}),r.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-lg font-medium",children:"Connect with your university community"})]}),r.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-3xl shadow-2xl border-2 border-slate-200 dark:border-slate-700 p-8 relative",children:[r.jsxs("form",{onSubmit:T,className:"space-y-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{htmlFor:"identifier",className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"Username or University Email"}),r.jsx(ie,{id:"identifier",type:"text",value:e,onChange:j=>W(j.target.value),placeholder:"username or yourname@uni.edu.pk",autoComplete:"username",className:`rounded-2xl h-14 border-2 transition-all duration-300 text-lg px-4 ${i.identifier||n.identifier?"border-red-500 focus:border-red-500 focus:ring-red-500/20":e&&!i.identifier?"border-green-500 focus:border-green-500 focus:ring-green-500/20":"border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary/20"}`,required:!0,"aria-invalid":!!n.identifier,"aria-describedby":n.identifier?"identifier-error":void 0}),(n.identifier||i.identifier)&&r.jsx("div",{className:"mt-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"identifier-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",role:"alert","aria-live":"polite",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.identifier||i.identifier]})}),e&&!i.identifier&&!n.identifier&&r.jsx("div",{className:"mt-2 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl",children:r.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-green-600 dark:text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Looks good!"]})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx(ie,{id:"password",type:m?"text":"password",value:s,onChange:j=>N(j.target.value),placeholder:"Enter your password",autoComplete:"current-password",className:`rounded-2xl h-14 pr-12 border-2 transition-all duration-300 text-lg px-4 ${i.password||n.password?"border-red-500 focus:border-red-500 focus:ring-red-500/20":s&&!i.password?"border-green-500 focus:border-green-500 focus:ring-green-500/20":"border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary/20"}`,onKeyUp:j=>H(j.getModifierState?.("CapsLock")),onKeyDown:j=>H(j.getModifierState?.("CapsLock")),required:!0,"aria-invalid":!!n.password,"aria-describedby":n.password?"password-error":void 0}),r.jsx("button",{type:"button",onClick:()=>h(!m),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300 transition-colors duration-200","aria-label":m?"Hide password":"Show password",children:m?r.jsx(lt,{className:"w-5 h-5"}):r.jsx(dt,{className:"w-5 h-5"})})]}),F&&r.jsx("div",{className:"mt-2 p-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:r.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300 font-semibold flex items-center gap-1","aria-live":"polite",children:[r.jsx("span",{className:"text-amber-600 dark:text-amber-400",children:"⚠️"}),"Caps Lock is on"]})}),(n.password||i.password)&&r.jsx("div",{className:"mt-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"password-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",role:"alert","aria-live":"polite",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.password||i.password]})}),s&&!i.password&&!n.password&&!n.login&&r.jsx("div",{className:"mt-2 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl",children:r.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-green-600 dark:text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Password looks good!"]})}),n.login&&r.jsx("div",{className:"mt-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"login-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",role:"alert","aria-live":"polite",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.login]})})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[r.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-border text-primary focus:ring-primary",checked:p,onChange:j=>x(j.target.checked)}),"Remember me on this device"]}),r.jsxs(lr,{open:y,onOpenChange:v,children:[r.jsx(Wn,{asChild:!0,children:r.jsx("button",{type:"button",className:"text-sm text-primary hover:text-primary/80 font-semibold",children:"Forgot password?"})}),r.jsxs(cr,{children:[r.jsxs(ur,{children:[r.jsx(mr,{children:"Reset your password"}),r.jsx(hr,{children:"Enter your .edu.pk email and we will send reset instructions."})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(ie,{type:"email",placeholder:"yourname@your-university.edu.pk",autoComplete:"email",value:g,onChange:j=>{b(j.target.value),k(""),I(!1)}}),w&&r.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 font-semibold flex items-center gap-2",role:"alert","aria-live":"polite",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),w]})}),C&&r.jsx("p",{className:"text-sm text-primary",children:"If an account exists, a reset email was sent."})]}),r.jsx(Yn,{children:r.jsx(L,{type:"button",onClick:async()=>{if(!z.email(g)){k("Please enter a valid .edu.pk email");return}try{await ne.requestPasswordReset(g),I(!0),k("")}catch{k("Failed to send reset email")}},children:"Send reset link"})})]})]})]}),r.jsx(L,{type:"submit",className:"w-full rounded-2xl h-14 bg-primary hover:bg-primary/90 text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 border-2 border-primary hover:border-primary/80",disabled:d,children:d?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Signing in..."]}):"Sign In"})]}),r.jsx("div",{className:"text-center mt-8 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border-2 border-blue-200 dark:border-blue-800",children:r.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 font-semibold",children:"🔒 Only official .edu.pk university emails are allowed"})})]}),r.jsx("div",{className:"text-center mt-8",children:r.jsxs("p",{className:"text-slate-600 dark:text-slate-400 text-lg font-medium",children:["Don't have an account?"," ",r.jsx("button",{className:"text-primary hover:text-primary/80 font-bold underline transition-colors duration-200",onClick:()=>window.location.href="/signup",children:"Create one now"})]})})]})]})}function Jn({className:e,...t}){return r.jsx(Xr,{"data-slot":"checkbox",className:A("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:r.jsx(Jr,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:r.jsx(Os,{className:"size-3.5"})})})}function Kn(){const[e,t]=f.useState({username:"",email:"",password:"",confirmPassword:""}),[s,a]=f.useState({}),[n,l]=f.useState(!1),[i,o]=f.useState(null),[c,d]=f.useState(!1),[u,m]=f.useState(null),[h,p]=f.useState(!1),[x,y]=f.useState(!1),[v,g]=f.useState(!1),[b,w]=f.useState(!1),[k,C]=f.useState(null);he();const I=Ae(),F=(N,T)=>{if(t(j=>({...j,[N]:T})),s[N]&&a(j=>({...j,[N]:""})),N==="email"&&T){const j=z.email(T);j.valid||a(M=>({...M,email:j.message||""}))}else if(N==="username"&&T){const j=z.username(T);j.valid||a(M=>({...M,username:j.message||""}))}else if(N==="password"&&T){const j=z.password(T);j.valid||a(M=>({...M,password:j.message||""}))}};f.useEffect(()=>{const N=e.username.trim();if(!N){o(null);return}if(!z.username(N).valid){o(!1);return}l(!0);const j=setTimeout(async()=>{try{const M=await ne.checkUsernameAvailability(N);o(M)}finally{l(!1)}},400);return()=>clearTimeout(j)},[e.username]),f.useEffect(()=>{const N=e.email.trim(),T=N.includes("@")?N.split("@")[1].toLowerCase():"";if(C(T||null),!N||!z.email(N)){m(null);return}d(!0);const j=setTimeout(async()=>{try{const M=await ne.checkEmailAvailable(N);m(M)}finally{d(!1)}},400);return()=>clearTimeout(j)},[e.email]);const H=()=>{const N={};if(e.username.trim()?z.username(e.username).valid?i===!1&&(N.username="Username taken!"):N.username=z.username(e.username).message||"Invalid username":N.username="Username required!",!e.email.trim())N.email="Email required!";else{const j=z.email(e.email);j.valid?u===!1&&(N.email="Email in use!"):N.email=j.message||"Invalid email"}const T=z.password(e.password);return T.valid||(N.password=T.message||""),e.confirmPassword?e.password!==e.confirmPassword&&(N.confirmPassword="Passwords don't match!"):N.confirmPassword="Confirm password!",b||(N.terms="Agree to terms!"),a(N),Object.keys(N).length===0},W=async N=>{if(N.preventDefault(),!!H()){g(!0);try{await ne.signUp(e.email,e.password,e.username),I.success("Account created! Check your email to verify."),window.location.href="/"}catch(T){let j="Signup failed!";T instanceof Error&&(T.message.includes("network")||T.message.includes("fetch")?j="Network error!":j=T.message),I.error(j)}finally{g(!1)}}};return v?r.jsx(me,{fullScreen:!0,size:"lg",text:"Creating your account..."}):r.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/15 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"w-full max-w-md relative z-10",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-4xl font-brand text-primary mb-3",children:ae}),r.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-lg font-medium",children:"Join your university community"})]}),r.jsx("div",{className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-3xl shadow-2xl border-2 border-slate-200 dark:border-slate-700 p-8 relative",children:r.jsxs("form",{onSubmit:W,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{htmlFor:"username",className:"block text-sm font-bold text-slate-700 dark:text-slate-300",children:"Username"}),r.jsx(ie,{id:"username",value:e.username,onChange:N=>F("username",N.target.value),placeholder:"your_unique_handle",className:`rounded-2xl h-12 border-2 transition-all duration-300 ${s.username?"border-red-500 focus:border-red-500 focus:ring-red-500/20":e.username&&!s.username&&i===!0?"border-green-500 focus:border-green-500 focus:ring-green-500/20":"border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary/20"}`,"aria-invalid":!!s.username,"aria-describedby":s.username?"username-error":void 0}),r.jsxs("div",{className:"text-xs h-4",children:[n&&r.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Checking availability…"}),i===!0&&r.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:r.jsx("span",{className:"text-green-700 dark:text-green-300 font-semibold text-xs",children:"✓ Available"})}),i===!1&&r.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:r.jsx("span",{className:"text-red-700 dark:text-red-300 font-semibold text-xs",children:"✗ Username taken"})})]}),s.username&&r.jsx("div",{className:"mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"username-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.username]})})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-slate-700 dark:text-slate-300",children:"University Email (.edu.pk)"}),r.jsx(ie,{id:"email",type:"email",value:e.email,onChange:N=>F("email",N.target.value),placeholder:"your.name@your-university.edu.pk",autoComplete:"email",className:`rounded-2xl h-12 border-2 transition-all duration-300 ${s.email?"border-red-500 focus:border-red-500 focus:ring-red-500/20":e.email&&!s.email&&u===!0?"border-green-500 focus:border-green-500 focus:ring-green-500/20":"border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary/20"}`,"aria-invalid":!!s.email,"aria-describedby":s.email?"email-error":void 0}),r.jsxs("div",{className:"text-xs h-4 flex items-center gap-2",children:[c&&r.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Checking email…"}),u===!0&&r.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:r.jsx("span",{className:"text-green-700 dark:text-green-300 font-semibold text-xs",children:"✓ Email available"})}),u===!1&&r.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:r.jsx("span",{className:"text-red-700 dark:text-red-300 font-semibold text-xs",children:"✗ Email already in use"})}),k&&r.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:["📍 ",k]})]}),s.email&&r.jsx("div",{className:"mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"email-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.email]})})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-slate-700 dark:text-slate-300",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx(ie,{id:"password",type:h?"text":"password",value:e.password,onChange:N=>F("password",N.target.value),placeholder:"Enter your password",autoComplete:"new-password",className:`rounded-2xl h-12 pr-12 border-2 transition-all duration-300 ${s.password?"border-red-500 focus:border-red-500 focus:ring-red-500/20":e.password&&!s.password?"border-green-500 focus:border-green-500 focus:ring-green-500/20":"border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary/20"}`,"aria-invalid":!!s.password,"aria-describedby":s.password?"password-error":void 0}),r.jsx("button",{type:"button",onClick:()=>p(!h),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300 transition-colors duration-200",children:h?r.jsx(lt,{className:"w-5 h-5"}):r.jsx(dt,{className:"w-5 h-5"})})]}),s.password&&r.jsx("div",{className:"mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"password-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.password]})}),r.jsxs("div",{className:"mt-2 text-xs space-y-2 bg-slate-50 dark:bg-slate-800 p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx(xe,{className:`w-4 h-4 ${e.password.length>=8?"text-green-500":"text-slate-400"}`}),r.jsx("span",{className:e.password.length>=8?"text-green-600 dark:text-green-400 font-medium":"text-slate-500 dark:text-slate-400",children:"At least 8 characters"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx(xe,{className:`w-4 h-4 ${/[A-Z]/.test(e.password)?"text-green-500":"text-slate-400"}`}),r.jsx("span",{className:/[A-Z]/.test(e.password)?"text-green-600 dark:text-green-400 font-medium":"text-slate-500 dark:text-slate-400",children:"One uppercase letter"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx(xe,{className:`w-4 h-4 ${/[0-9]/.test(e.password)?"text-green-500":"text-slate-400"}`}),r.jsx("span",{className:/[0-9]/.test(e.password)?"text-green-600 dark:text-green-400 font-medium":"text-slate-500 dark:text-slate-400",children:"One number"})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-foreground",children:"Confirm Password"}),r.jsxs("div",{className:"relative",children:[r.jsx(ie,{id:"confirmPassword",type:x?"text":"password",value:e.confirmPassword,onChange:N=>F("confirmPassword",N.target.value),placeholder:"Confirm password",className:"rounded-2xl h-12 pr-12 border-2 border-border focus:border-primary focus:ring-primary/20 transition-all duration-300","aria-invalid":!!s.confirmPassword,"aria-describedby":s.confirmPassword?"confirmPassword-error":void 0}),r.jsx("button",{type:"button",onClick:()=>y(!x),className:"absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-gray-600 transition-colors duration-200",children:x?r.jsx(lt,{className:"w-5 h-5"}):r.jsx(dt,{className:"w-5 h-5"})})]}),s.confirmPassword&&r.jsx("div",{className:"mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{id:"confirmPassword-error",className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.confirmPassword]})})]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(Jn,{id:"terms",checked:b,onCheckedChange:N=>w(!!N),className:"mt-1"}),r.jsxs("label",{htmlFor:"terms",className:"text-sm text-foreground",children:["I agree to the ",r.jsx("a",{className:"text-primary hover:underline",href:"#",children:"Terms of Service"})," and ",r.jsx("a",{className:"text-primary hover:underline",href:"#",children:"Privacy Policy"}),"."]})]}),s.terms&&r.jsx("div",{className:"mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.terms]})}),r.jsx(L,{type:"submit",className:"w-full rounded-2xl h-14 bg-primary hover:bg-primary/90 text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed border-2 border-primary hover:border-primary/80",disabled:v,children:v?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating..."]}):"Create Account"})]})}),r.jsx("div",{className:"text-center mt-8",children:r.jsxs("p",{className:"text-slate-600 dark:text-slate-400 text-lg font-medium",children:["Already have an account?"," ",r.jsx("button",{className:"text-primary hover:text-primary/80 font-bold underline transition-colors duration-200",onClick:()=>window.history.back(),children:"Sign in"})]})})]})]})}function Ye({...e}){return r.jsx(Kr,{"data-slot":"select",...e})}function Xe({...e}){return r.jsx(ea,{"data-slot":"select-value",...e})}function Je({className:e,size:t="default",children:s,...a}){return r.jsxs(Zr,{"data-slot":"select-trigger","data-size":t,className:A("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-2xl border-2 bg-input-background px-4 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-11 data-[size=sm]:h-9 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a,children:[s,r.jsx(Qr,{asChild:!0,children:r.jsx(Vs,{className:"size-4 opacity-50"})})]})}function Ke({className:e,children:t,position:s="popper",...a}){return r.jsx(ta,{children:r.jsxs(sa,{"data-slot":"select-content",className:A("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-xl border-2 shadow-lg",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[r.jsx(Zn,{}),r.jsx(ra,{className:A("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),r.jsx(Qn,{})]})})}function Ze({className:e,children:t,...s}){return r.jsxs(aa,{"data-slot":"select-item",className:A("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...s,children:[r.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:r.jsx(na,{children:r.jsx(Os,{className:"size-4"})})}),r.jsx(ia,{children:t})]})}function Zn({className:e,...t}){return r.jsx(oa,{"data-slot":"select-scroll-up-button",className:A("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(ja,{className:"size-4"})})}function Qn({className:e,...t}){return r.jsx(la,{"data-slot":"select-scroll-down-button",className:A("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(Vs,{className:"size-4"})})}function fr({className:e,...t}){return r.jsx("textarea",{"data-slot":"textarea",className:A("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-20 w-full rounded-2xl border-2 bg-input-background px-4 py-3 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}function ei(){const[e,t]=f.useState(1),[s,a]=f.useState({name:"",dob:"",gender:"",department:"",batch:"",session:"",year:"",bio:"",interests:[],societies:[],avatar:""}),{completeOnboarding:n,isLoading:l}=he(),i=Ae(),o=5,c=()=>{e<o&&t(e+1)},d=()=>{e>1&&t(e-1)},u=(g,b)=>{a(w=>({...w,[g]:b}))},m=g=>{a(b=>({...b,interests:b.interests.includes(g)?b.interests.filter(w=>w!==g):[...b.interests,g]}))},h=()=>{switch(e){case 1:return s.session&&s.year;case 2:return s.department;case 3:return s.bio.length>=10;case 4:return s.interests.length>=2&&s.interests.length<=5;case 5:return!0;default:return!1}},p=async()=>{try{await n({department:s.department,session:s.session,year:s.year,batch:`${s.session} ${s.year}`,interests:s.interests})}catch{i.error("Failed to complete onboarding. Please try again.")}};if(l)return r.jsx(me,{fullScreen:!0,size:"lg",text:"Setting up your profile..."});const x=g=>{switch(g){case 1:return r.jsx(Pa,{className:"w-5 h-5"});case 2:return r.jsx(ka,{className:"w-5 h-5"});case 3:return r.jsx(Us,{className:"w-5 h-5"});case 4:return r.jsx(_a,{className:"w-5 h-5"});case 5:return r.jsx(Ct,{className:"w-5 h-5"});default:return r.jsx(xe,{className:"w-5 h-5"})}},y=g=>{switch(g){case 1:return"Select Your Batch";case 2:return"Department";case 3:return"Tell us about yourself";case 4:return"Your interests";case 5:return"Profile setup";default:return"Welcome!"}},v=g=>{switch(g){case 1:return"Which batch are you from?";case 2:return"Which department are you in?";case 3:return"Share a bit about yourself";case 4:return"Select up to 5 interests";case 5:return"Almost done! Let's finish your profile";default:return"You're all set!"}};return e===6?r.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/15 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"})]}),r.jsx("div",{className:"w-full max-w-md text-center relative z-10",children:r.jsxs("div",{className:"bg-card/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-border p-8",children:[r.jsx("div",{className:"w-24 h-24 rounded-full bg-primary flex items-center justify-center mx-auto mb-8 shadow-2xl shadow-primary/25 ring-4 ring-primary/20",children:r.jsx(xe,{className:"w-12 h-12 text-white"})}),r.jsxs("h2",{className:"text-3xl font-bold mb-4 text-primary",children:["Welcome to ",ae,"!"]}),r.jsxs("div",{className:"space-y-2 mb-8",children:[r.jsxs("p",{className:"text-lg text-muted-foreground",children:["You're all set, ",r.jsx("span",{className:"font-semibold text-primary",children:s.batch})]}),r.jsx("p",{className:"text-lg text-muted-foreground",children:s.department})]}),r.jsx(L,{onClick:p,className:"w-full rounded-2xl h-14 bg-primary hover:bg-primary/90 text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 border-2 border-primary hover:border-primary/80",disabled:l,children:l?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Setting up..."]}):"Get Started"})]})})]}):r.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/15 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"w-full max-w-md relative z-10",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h2",{className:"text-3xl font-bold mb-3 text-primary",children:"Complete Your Profile"}),r.jsx("p",{className:"text-muted-foreground text-lg",children:"Help us personalize your experience"})]}),r.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-3xl shadow-2xl border-2 border-slate-200 dark:border-slate-700 p-8 relative",children:[r.jsx("div",{className:"flex items-center gap-3 mb-8",children:Array.from({length:o},(g,b)=>r.jsx("div",{className:`flex-1 h-3 rounded-full transition-all duration-500 ${e>b+1?"bg-primary shadow-lg shadow-primary/30":e===b+1?"bg-primary/70 shadow-md shadow-primary/20":"bg-muted"}`},b))}),r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-16 h-16 rounded-2xl bg-primary/10 dark:bg-primary/20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:r.jsx("div",{className:"w-8 h-8 text-primary",children:x(e)})}),r.jsx("h3",{className:"text-2xl font-bold mb-3 text-primary",children:y(e)}),r.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-lg font-medium",children:v(e)})]}),r.jsxs("div",{className:"space-y-6",children:[e===1&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-lg font-semibold text-foreground mb-2",children:"Select Your Session"}),r.jsxs(Ye,{value:s.session,onValueChange:g=>u("session",g),children:[r.jsx(Je,{className:"w-full rounded-2xl h-14 border-2 border-border focus:border-primary focus:ring-primary/20 transition-all duration-300 text-lg",children:r.jsx(Xe,{placeholder:"Choose your session..."})}),r.jsx(Ke,{className:"rounded-2xl border-2 border-border shadow-xl",children:Cn.map(g=>r.jsx(Ze,{value:g,className:"text-lg py-3",children:g},g))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-lg font-semibold text-foreground mb-2",children:"Select Your Year"}),r.jsxs(Ye,{value:s.year,onValueChange:g=>u("year",g),children:[r.jsx(Je,{className:"w-full rounded-2xl h-14 border-2 border-border focus:border-primary focus:ring-primary/20 transition-all duration-300 text-lg",children:r.jsx(Xe,{placeholder:"Choose your year..."})}),r.jsx(Ke,{className:"rounded-2xl border-2 border-border shadow-xl",children:Tn.map(g=>r.jsx(Ze,{value:g,className:"text-lg py-3",children:g},g))})]})]})]}),e===2&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("label",{className:"block text-lg font-semibold text-foreground",children:"Select Your Department"}),r.jsxs(Ye,{value:s.department,onValueChange:g=>u("department",g),children:[r.jsx(Je,{className:"w-full rounded-2xl h-14 border-2 border-border focus:border-primary focus:ring-primary/20 transition-all duration-300 text-lg",children:r.jsx(Xe,{placeholder:"Choose your department..."})}),r.jsx(Ke,{className:"rounded-2xl border-2 border-border shadow-xl",children:En.map(g=>r.jsx(Ze,{value:g,className:"text-lg py-3",children:g},g))})]})]}),e===3&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("label",{className:"block text-lg font-semibold text-foreground",children:"Bio"}),r.jsx(fr,{value:s.bio,onChange:g=>u("bio",g.target.value),placeholder:"Tell us about yourself, your goals, hobbies, or anything you'd like to share...",className:"rounded-2xl min-h-[120px] resize-none border-2 border-border focus:border-primary focus:ring-primary/20 transition-all duration-300 text-lg p-4"}),r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsxs("p",{className:"text-muted-foreground",children:[s.bio.length,"/160 characters (minimum 10)"]}),r.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.bio.length>=10?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`,children:s.bio.length>=10?"✓ Valid":"Too short"})]})]}),e===4&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-lg font-semibold text-foreground mb-2",children:"Select Your Interests"}),r.jsx("p",{className:"text-muted-foreground text-lg",children:"Choose at least 2 interests"})]}),r.jsx("div",{className:"grid grid-cols-2 gap-4",children:An.map(g=>r.jsx("button",{onClick:()=>m(g),className:`p-4 rounded-2xl border-2 text-lg font-semibold transition-all duration-300 ${s.interests.includes(g)?"border-primary bg-gradient-to-br from-primary/5 to-accent/5 text-primary shadow-lg shadow-primary/20":"border-border hover:border-primary hover:bg-accent text-foreground"}`,children:g},g))}),r.jsx("div",{className:"text-center",children:r.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium ${s.interests.length>=2?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`,children:[r.jsxs("span",{children:[s.interests.length," selected"]}),s.interests.length>=2&&r.jsx(xe,{className:"w-4 h-4"})]})})]}),e===5&&r.jsxs("div",{className:"text-center space-y-6",children:[r.jsx("div",{className:"w-24 h-24 rounded-3xl bg-gradient-to-br from-primary/10 to-accent/10 dark:from-primary/20 dark:to-accent/20 flex items-center justify-center mx-auto shadow-lg",children:r.jsx(Ct,{className:"w-10 h-10 text-primary"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-xl font-bold mb-3 text-foreground",children:"Profile Picture"}),r.jsx("p",{className:"text-muted-foreground text-lg mb-6",children:"You can add a profile picture later in settings"}),r.jsx(L,{variant:"outline",className:"rounded-2xl h-12 px-8 border-2 border-border hover:border-primary hover:bg-accent font-semibold",children:"Upload Photo"})]})]}),r.jsxs("div",{className:"flex gap-4 pt-6",children:[e>1&&r.jsxs(L,{onClick:d,variant:"outline",className:"flex-1 rounded-2xl h-14 border-2 border-border hover:border-primary hover:bg-accent font-semibold",children:[r.jsx(Sa,{className:"w-5 h-5 mr-2"}),"Back"]}),r.jsxs(L,{onClick:e===o?()=>t(6):c,disabled:!h(),className:`${e===1?"w-full":"flex-1"} rounded-2xl h-14 bg-primary hover:bg-primary/90 text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed border-2 border-primary hover:border-primary/80`,children:[e===o?"Review":"Continue",e<o&&r.jsx(Na,{className:"w-5 h-5 ml-2"})]})]})]})]})]})]})}function Ut(){const[e,t]=f.useState(30),[s,a]=f.useState(!1),[n,l]=f.useState(!1),i=(()=>{try{const d=localStorage.getItem(E.USER_DATA)||sessionStorage.getItem(E.USER_DATA);return d&&JSON.parse(d)?.email||"your .edu.pk email"}catch{return"your .edu.pk email"}})();f.useEffect(()=>{const d=setInterval(()=>t(u=>u>0?u-1:0),1e3);return()=>clearInterval(d)},[]);const o=async()=>{if(!(e>0)){a(!0);try{await ne.sendVerificationEmail(i),l(!0),t(30)}finally{a(!1)}}},c=()=>{try{localStorage.setItem(E.EMAIL_VERIFIED,"true"),window.location.reload()}catch{}};return r.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/15 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-3xl shadow-2xl border-2 border-slate-200 dark:border-slate-700 p-8 max-w-md w-full text-center relative z-10",children:[r.jsxs("h1",{className:"text-3xl font-bold mb-2 text-primary",children:["Welcome to ",r.jsx("span",{className:"font-brand text-primary",children:ae}),"!"]}),r.jsxs("p",{className:"text-slate-600 dark:text-slate-400 mb-6 font-medium",children:["We just sent a confirmation link to ",r.jsx("span",{className:"font-bold text-primary",children:i}),".",r.jsx("br",{}),"Tap the link to verify your account."]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(L,{onClick:c,className:"w-full rounded-2xl h-12 bg-primary hover:bg-primary/90 text-white font-bold border-2 border-primary hover:border-primary/80",children:"I clicked the email, continue"}),r.jsx(L,{onClick:o,variant:"outline",disabled:e>0||s,className:"w-full rounded-2xl h-12 border-2 border-slate-300 dark:border-slate-600 hover:border-primary hover:bg-primary/10 font-bold text-slate-700 dark:text-slate-300",children:e>0?`Resend available in ${e}s`:n?"Sent! Resend again":s?"Sending...":"Resend email"})]})]})]})}function ti(){const[e,t]=f.useState(""),[s,a]=f.useState(""),[n,l]=f.useState(!1),[i,o]=f.useState(!0),[c,d]=f.useState(!1),u=Ae();f.useEffect(()=>{let p;return(async()=>{try{const{data:v}=await _.auth.getSession();d(!!v.session)}finally{o(!1)}const{data:y}=_.auth.onAuthStateChange((v,g)=>{d(!!g)});p=()=>y.subscription.unsubscribe()})(),()=>{p&&p()}},[]);const m=e.length>=8&&e===s&&c&&!n,h=async()=>{if(m){l(!0);try{const{error:p}=await _.auth.updateUser({password:e});if(p)throw new Error(p.message);u.success("Password updated. You can sign in now."),window.location.href="/"}catch(p){const x=p instanceof Error?p.message:"Failed to update password";u.error(x)}finally{l(!1)}}};return i?r.jsx(me,{fullScreen:!0,size:"lg",text:"Preparing reset..."}):r.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/15 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-3xl shadow-2xl border-2 border-slate-200 dark:border-slate-700 p-8 max-w-md w-full relative z-10",children:[r.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Reset your password"}),!c&&r.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 font-semibold flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"The reset link is invalid or expired. Please request a new reset email."]})}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"newpass",className:"block text-sm font-semibold text-foreground",children:"New password"}),r.jsx(ie,{id:"newpass",type:"password",value:e,onChange:p=>t(p.target.value),placeholder:"At least 8 characters",className:"rounded-2xl h-12 border-2 border-border focus:border-primary focus:ring-primary/20"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmpass",className:"block text-sm font-semibold text-foreground",children:"Confirm password"}),r.jsx(ie,{id:"confirmpass",type:"password",value:s,onChange:p=>a(p.target.value),placeholder:"Re-enter password",className:"rounded-2xl h-12 border-2 border-border focus:border-primary focus:ring-primary/20"})]}),e&&e.length<8&&r.jsx("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters."}),s&&s!==e&&r.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{className:"text-xs text-red-700 dark:text-red-300 font-semibold flex items-center gap-2",children:[r.jsx("svg",{className:"w-3 h-3 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Passwords do not match."]})}),r.jsx(L,{className:"w-full rounded-2xl h-12 bg-gradient-to-r from-primary to-accent text-white",disabled:!m,onClick:h,children:n?"Updating...":"Update Password"})]})]})]})}const si=Ms("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function pr({className:e,variant:t,asChild:s=!1,...a}){const n=s?Ps:"span";return r.jsx(n,{"data-slot":"badge",className:A(si({variant:t}),e),...a})}function Fe({className:e,...t}){return r.jsx(da,{"data-slot":"avatar",className:A("relative flex size-10 shrink-0 overflow-hidden rounded-full",e),...t})}function Bt({className:e,...t}){return r.jsx(ua,{"data-slot":"avatar-image",className:A("aspect-square size-full",e),...t})}function $e({className:e,...t}){return r.jsx(ca,{"data-slot":"avatar-fallback",className:A("bg-muted flex size-full items-center justify-center rounded-full",e),...t})}const Qe=768;function ri(){const[e,t]=f.useState(void 0);return f.useEffect(()=>{const s=window.matchMedia(`(max-width: ${Qe-1}px)`),a=()=>{t(window.innerWidth<Qe)};return s.addEventListener("change",a),t(window.innerWidth<Qe),()=>s.removeEventListener("change",a)},[]),!!e}const jt=f.createContext({});function St(e){const t=f.useRef(null);return t.current===null&&(t.current=e()),t.current}const Ge=f.createContext(null),Nt=f.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class ai extends f.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const a=this.props.sizeRef.current;a.height=s.offsetHeight||0,a.width=s.offsetWidth||0,a.top=s.offsetTop,a.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ni({children:e,isPresent:t}){const s=f.useId(),a=f.useRef(null),n=f.useRef({width:0,height:0,top:0,left:0}),{nonce:l}=f.useContext(Nt);return f.useInsertionEffect(()=>{const{width:i,height:o,top:c,left:d}=n.current;if(t||!a.current||!i||!o)return;a.current.dataset.motionPopId=s;const u=document.createElement("style");return l&&(u.nonce=l),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${c}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),r.jsx(ai,{isPresent:t,childRef:a,sizeRef:n,children:f.cloneElement(e,{ref:a})})}const ii=({children:e,initial:t,isPresent:s,onExitComplete:a,custom:n,presenceAffectsLayout:l,mode:i})=>{const o=St(oi),c=f.useId(),d=f.useCallback(m=>{o.set(m,!0);for(const h of o.values())if(!h)return;a&&a()},[o,a]),u=f.useMemo(()=>({id:c,initial:t,isPresent:s,custom:n,onExitComplete:d,register:m=>(o.set(m,!1),()=>o.delete(m))}),l?[Math.random(),d]:[s,d]);return f.useMemo(()=>{o.forEach((m,h)=>o.set(h,!1))},[s]),f.useEffect(()=>{!s&&!o.size&&a&&a()},[s]),i==="popLayout"&&(e=r.jsx(ni,{isPresent:s,children:e})),r.jsx(Ge.Provider,{value:u,children:e})};function oi(){return new Map}function gr(e=!0){const t=f.useContext(Ge);if(t===null)return[!0,null];const{isPresent:s,onExitComplete:a,register:n}=t,l=f.useId();f.useEffect(()=>{e&&n(l)},[e]);const i=f.useCallback(()=>e&&a&&a(l),[l,a,e]);return!s&&a?[!1,i]:[!0]}const Le=e=>e.key||"";function zt(e){const t=[];return f.Children.forEach(e,s=>{f.isValidElement(s)&&t.push(s)}),t}const xr=$s?f.useLayoutEffect:f.useEffect,li=({children:e,custom:t,initial:s=!0,onExitComplete:a,presenceAffectsLayout:n=!0,mode:l="sync",propagate:i=!1})=>{const[o,c]=gr(i),d=f.useMemo(()=>zt(e),[e]),u=i&&!o?[]:d.map(Le),m=f.useRef(!0),h=f.useRef(d),p=St(()=>new Map),[x,y]=f.useState(d),[v,g]=f.useState(d);xr(()=>{m.current=!1,h.current=d;for(let k=0;k<v.length;k++){const C=Le(v[k]);u.includes(C)?p.delete(C):p.get(C)!==!0&&p.set(C,!1)}},[v,u.length,u.join("-")]);const b=[];if(d!==x){let k=[...d];for(let C=0;C<v.length;C++){const I=v[C],F=Le(I);u.includes(F)||(k.splice(C,0,I),b.push(I))}l==="wait"&&b.length&&(k=b),g(zt(k)),y(d);return}const{forceRender:w}=f.useContext(jt);return r.jsx(r.Fragment,{children:v.map(k=>{const C=Le(k),I=i&&!o?!1:d===v||u.includes(C),F=()=>{if(p.has(C))p.set(C,!0);else return;let H=!0;p.forEach(W=>{W||(H=!1)}),H&&(w?.(),g(h.current),i&&c?.(),a&&a())};return r.jsx(ii,{isPresent:I,initial:!m.current||s?void 0:!1,custom:I?void 0:t,presenceAffectsLayout:n,mode:l,onExitComplete:I?void 0:F,children:k},C)})})},vr=f.createContext({strict:!1});function di(e){for(const t in e)ut[t]={...ut[t],...e[t]}}const ci=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function He(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||ci.has(e)}let yr=e=>!He(e);function ui(e){e&&(yr=t=>t.startsWith("on")?!He(t):e(t))}try{ui(require("@emotion/is-prop-valid").default)}catch{}function mi(e,t,s){const a={};for(const n in e)n==="values"&&typeof e.values=="object"||(yr(n)||s===!0&&He(n)||!t&&!He(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}function hi(e){if(typeof Proxy>"u")return e;const t=new Map,s=(...a)=>e(...a);return new Proxy(s,{get:(a,n)=>n==="create"?e:(t.has(n)||t.set(n,e(n)),t.get(n))})}const We=f.createContext({});function fi(e,t){if(Hs(e)){const{initial:s,animate:a}=e;return{initial:s===!1||Be(s)?s:void 0,animate:Be(a)?a:void 0}}return e.inherit!==!1?t:{}}function pi(e){const{initial:t,animate:s}=fi(e,f.useContext(We));return f.useMemo(()=>({initial:t,animate:s}),[Ft(t),Ft(s)])}function Ft(e){return Array.isArray(e)?e.join(" "):e}const gi=Symbol.for("motionComponentSymbol");function ge(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function xi(e,t,s){return f.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),s&&(typeof s=="function"?s(a):ge(s)&&(s.current=a))},[t])}const{schedule:_t}=$a(queueMicrotask,!1),br=f.createContext({});function vi(e,t,s,a,n){var l,i;const{visualElement:o}=f.useContext(We),c=f.useContext(vr),d=f.useContext(Ge),u=f.useContext(Nt).reducedMotion,m=f.useRef(null);a=a||c.renderer,!m.current&&a&&(m.current=a(e,{visualState:t,parent:o,props:s,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:u}));const h=m.current,p=f.useContext(br);h&&!h.projection&&n&&(h.type==="html"||h.type==="svg")&&yi(m.current,s,n,p);const x=f.useRef(!1);f.useInsertionEffect(()=>{h&&x.current&&h.update(s,d)});const y=s[Ha],v=f.useRef(!!y&&!(!((l=window.MotionHandoffIsComplete)===null||l===void 0)&&l.call(window,y))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,y)));return xr(()=>{h&&(x.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),_t.render(h.render),v.current&&h.animationState&&h.animationState.animateChanges())}),f.useEffect(()=>{h&&(!v.current&&h.animationState&&h.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,y)}),v.current=!1))}),h}function yi(e,t,s,a){const{layoutId:n,layout:l,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:d}=t;e.projection=new s(e.latestValues,t["data-framer-portal-id"]?void 0:wr(e.parent)),e.projection.setOptions({layoutId:n,layout:l,alwaysMeasureLayout:!!i||o&&ge(o),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:a,layoutScroll:c,layoutRoot:d})}function wr(e){if(e)return e.options.allowProjection!==!1?e.projection:wr(e.parent)}function bi({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:a,Component:n}){var l,i;e&&di(e);function o(d,u){let m;const h={...f.useContext(Nt),...d,layoutId:wi(d)},{isStatic:p}=h,x=pi(d),y=a(d,p);if(!p&&$s){ji();const v=Si(h);m=v.MeasureLayout,x.visualElement=vi(n,y,h,t,v.ProjectionNode)}return r.jsxs(We.Provider,{value:x,children:[m&&x.visualElement?r.jsx(m,{visualElement:x.visualElement,...h}):null,s(n,d,xi(y,x.visualElement,u),y,p,x.visualElement)]})}o.displayName=`motion.${typeof n=="string"?n:`create(${(i=(l=n.displayName)!==null&&l!==void 0?l:n.name)!==null&&i!==void 0?i:""})`}`;const c=f.forwardRef(o);return c[gi]=n,c}function wi({layoutId:e}){const t=f.useContext(jt).id;return t&&e!==void 0?t+"-"+e:e}function ji(e,t){f.useContext(vr).strict}function Si(e){const{drag:t,layout:s}=ut;if(!t&&!s)return{};const a={...t,...s};return{MeasureLayout:t?.isEnabled(e)||s?.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}const Ni=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function kt(e){return typeof e!="string"||e.includes("-")?!1:!!(Ni.indexOf(e)>-1||/[A-Z]/u.test(e))}function Ve(e){const t=yt(e)?e.get():e;return Ga(t)?t.toValue():t}function _i({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:s},a,n,l){const i={latestValues:ki(a,n,l,e),renderState:t()};return s&&(i.onMount=o=>s({props:a,current:o,...i}),i.onUpdate=o=>s(o)),i}const jr=e=>(t,s)=>{const a=f.useContext(We),n=f.useContext(Ge),l=()=>_i(e,t,a,n);return s?l():St(l)};function ki(e,t,s,a){const n={},l=a(e,{});for(const h in l)n[h]=Ve(l[h]);let{initial:i,animate:o}=e;const c=Hs(e),d=Wa(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let u=s?s.initial===!1:!1;u=u||i===!1;const m=u?o:i;if(m&&typeof m!="boolean"&&!bt(m)){const h=Array.isArray(m)?m:[m];for(let p=0;p<h.length;p++){const x=qa(e,h[p]);if(x){const{transitionEnd:y,transition:v,...g}=x;for(const b in g){let w=g[b];if(Array.isArray(w)){const k=u?w.length-1:0;w=w[k]}w!==null&&(n[b]=w)}for(const b in y)n[b]=y[b]}}}return n}const Pt=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Sr=()=>({...Pt(),attrs:{}});function Pi(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const $t=["x","y","width","height","cx","cy","r"],Ei={useVisualState:jr({scrapeMotionValuesFromProps:Ya,createRenderState:Sr,onUpdate:({props:e,prevProps:t,current:s,renderState:a,latestValues:n})=>{if(!s)return;let l=!!e.drag;if(!l){for(const o in n)if(Xa.has(o)){l=!0;break}}if(!l)return;let i=!t;if(t)for(let o=0;o<$t.length;o++){const c=$t[o];e[c]!==t[c]&&(i=!0)}i&&G.read(()=>{Pi(s,a),G.render(()=>{Gs(a,n,Ws(s.tagName),e.transformTemplate),Ja(s,a)})})}})},Ci={useVisualState:jr({scrapeMotionValuesFromProps:Ka,createRenderState:Pt})};function Nr(e,t,s){for(const a in t)!yt(t[a])&&!Za(a,s)&&(e[a]=t[a])}function Ti({transformTemplate:e},t){return f.useMemo(()=>{const s=Pt();return Qa(s,t,e),Object.assign({},s.vars,s.style)},[t])}function Ai(e,t){const s=e.style||{},a={};return Nr(a,s,e),Object.assign(a,Ti(e,t)),a}function Ri(e,t){const s={},a=Ai(e,t);return e.drag&&e.dragListener!==!1&&(s.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=a,s}function Di(e,t,s,a){const n=f.useMemo(()=>{const l=Sr();return Gs(l,t,Ws(a),e.transformTemplate),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};Nr(l,e.style,e),n.style={...l,...n.style}}return n}function Ii(e=!1){return(s,a,n,{latestValues:l},i)=>{const c=(kt(s)?Di:Ri)(a,l,i,s),d=mi(a,typeof s=="string",e),u=s!==f.Fragment?{...d,...c,ref:n}:{},{children:m}=a,h=f.useMemo(()=>yt(m)?m.get():m,[m]);return f.createElement(s,{...u,children:h})}}function Mi(e,t){return function(a,{forwardMotionProps:n}={forwardMotionProps:!1}){const i={...kt(a)?Ei:Ci,preloadedFeatures:e,useRender:Ii(n),createVisualElement:t,Component:a};return bi(i)}}function _r(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let a=0;a<s;a++)if(t[a]!==e[a])return!1;return!0}function ft(e,t,s={}){var a;const n=wt(e,t,s.type==="exit"?(a=e.presenceContext)===null||a===void 0?void 0:a.custom:void 0);let{transition:l=e.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(l=s.transitionOverride);const i=n?()=>Promise.all(qs(e,n,s)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:m,staggerDirection:h}=l;return Li(e,t,u+d,m,h,s)}:()=>Promise.resolve(),{when:c}=l;if(c){const[d,u]=c==="beforeChildren"?[i,o]:[o,i];return d().then(()=>u())}else return Promise.all([i(),o(s.delay)])}function Li(e,t,s=0,a=0,n=1,l){const i=[],o=(e.variantChildren.size-1)*a,c=n===1?(d=0)=>d*a:(d=0)=>o-d*a;return Array.from(e.variantChildren).sort(Oi).forEach((d,u)=>{d.notify("AnimationStart",t),i.push(ft(d,t,{...l,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(i)}function Oi(e,t){return e.sortNodePosition(t)}function Vi(e,t,s={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const n=t.map(l=>ft(e,l,s));a=Promise.all(n)}else if(typeof t=="string")a=ft(e,t,s);else{const n=typeof t=="function"?wt(e,t,s.custom):t;a=Promise.all(qs(e,n,s))}return a.then(()=>{e.notify("AnimationComplete",t)})}const Ui=Ys.length;function kr(e){if(!e)return;if(!e.isControllingVariants){const s=e.parent?kr(e.parent)||{}:{};return e.props.initial!==void 0&&(s.initial=e.props.initial),s}const t={};for(let s=0;s<Ui;s++){const a=Ys[s],n=e.props[a];(Be(n)||n===!1)&&(t[a]=n)}return t}const Bi=[...Xs].reverse(),zi=Xs.length;function Fi(e){return t=>Promise.all(t.map(({animation:s,options:a})=>Vi(e,s,a)))}function $i(e){let t=Fi(e),s=Ht(),a=!0;const n=c=>(d,u)=>{var m;const h=wt(e,u,c==="exit"?(m=e.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(h){const{transition:p,transitionEnd:x,...y}=h;d={...d,...y,...x}}return d};function l(c){t=c(e)}function i(c){const{props:d}=e,u=kr(e.parent)||{},m=[],h=new Set;let p={},x=1/0;for(let v=0;v<zi;v++){const g=Bi[v],b=s[g],w=d[g]!==void 0?d[g]:u[g],k=Be(w),C=g===c?b.isActive:null;C===!1&&(x=v);let I=w===u[g]&&w!==d[g]&&k;if(I&&a&&e.manuallyAnimateOnMount&&(I=!1),b.protectedKeys={...p},!b.isActive&&C===null||!w&&!b.prevProp||bt(w)||typeof w=="boolean")continue;const F=Hi(b.prevProp,w);let H=F||g===c&&b.isActive&&!I&&k||v>x&&k,W=!1;const N=Array.isArray(w)?w:[w];let T=N.reduce(n(g),{});C===!1&&(T={});const{prevResolvedValues:j={}}=b,M={...j,...T},B=R=>{H=!0,h.has(R)&&(W=!0,h.delete(R)),b.needsAnimating[R]=!0;const Z=e.getValue(R);Z&&(Z.liveStyle=!1)};for(const R in M){const Z=T[R],ye=j[R];if(p.hasOwnProperty(R))continue;let be=!1;Rt(Z)&&Rt(ye)?be=!_r(Z,ye):be=Z!==ye,be?Z!=null?B(R):h.add(R):Z!==void 0&&h.has(R)?B(R):b.protectedKeys[R]=!0}b.prevProp=w,b.prevResolvedValues=T,b.isActive&&(p={...p,...T}),a&&e.blockInitialAnimation&&(H=!1),H&&(!(I&&F)||W)&&m.push(...N.map(R=>({animation:R,options:{type:g}})))}if(h.size){const v={};h.forEach(g=>{const b=e.getBaseTarget(g),w=e.getValue(g);w&&(w.liveStyle=!0),v[g]=b??null}),m.push({animation:v})}let y=!!m.length;return a&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(y=!1),a=!1,y?t(m):Promise.resolve()}function o(c,d){var u;if(s[c].isActive===d)return Promise.resolve();(u=e.variantChildren)===null||u===void 0||u.forEach(h=>{var p;return(p=h.animationState)===null||p===void 0?void 0:p.setActive(c,d)}),s[c].isActive=d;const m=i(c);for(const h in s)s[h].protectedKeys={};return m}return{animateChanges:i,setActive:o,setAnimateFunction:l,getState:()=>s,reset:()=>{s=Ht(),a=!0}}}function Hi(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!_r(t,e):!1}function ce(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ht(){return{animate:ce(!0),whileInView:ce(),whileHover:ce(),whileTap:ce(),whileDrag:ce(),whileFocus:ce(),exit:ce()}}class de{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Gi extends de{constructor(t){super(t),t.animationState||(t.animationState=$i(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();bt(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let Wi=0;class qi extends de{constructor(){super(...arguments),this.id=Wi++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const n=this.node.animationState.setActive("exit",!t);s&&!t&&n.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Yi={animation:{Feature:Gi},exit:{Feature:qi}};function Xi(e){return e==="x"||e==="y"?re[e]?null:(re[e]=!0,()=>{re[e]=!1}):re.x||re.y?null:(re.x=re.y=!0,()=>{re.x=re.y=!1})}const Et=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Ce(e,t,s,a={passive:!0}){return e.addEventListener(t,s,a),()=>e.removeEventListener(t,s)}function Re(e){return{point:{x:e.pageX,y:e.pageY}}}const Ji=e=>t=>Et(t)&&e(t,Re(t));function ke(e,t,s,a){return Ce(e,t,Ji(s),a)}class Pr{constructor(t,s,{transformPagePoint:a,contextWindow:n,dragSnapToOrigin:l=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=tt(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=en(m.offset,{x:0,y:0})>=3;if(!h&&!p)return;const{point:x}=m,{timestamp:y}=Y;this.history.push({...x,timestamp:y});const{onStart:v,onMove:g}=this.handlers;h||(v&&v(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,m)},this.handlePointerMove=(m,h)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=et(h,this.transformPagePoint),G.update(this.updatePoint,!0)},this.handlePointerUp=(m,h)=>{this.end();const{onEnd:p,onSessionEnd:x,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=tt(m.type==="pointercancel"?this.lastMoveEventInfo:et(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(m,v),x&&x(m,v)},!Et(t))return;this.dragSnapToOrigin=l,this.handlers=s,this.transformPagePoint=a,this.contextWindow=n||window;const i=Re(t),o=et(i,this.transformPagePoint),{point:c}=o,{timestamp:d}=Y;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(t,tt(o,this.history)),this.removeListeners=Js(ke(this.contextWindow,"pointermove",this.handlePointerMove),ke(this.contextWindow,"pointerup",this.handlePointerUp),ke(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),mt(this.updatePoint)}}function et(e,t){return t?{point:t(e.point)}:e}function Gt(e,t){return{x:e.x-t.x,y:e.y-t.y}}function tt({point:e},t){return{point:e,delta:Gt(e,Er(t)),offset:Gt(e,Ki(t)),velocity:Zi(t,.1)}}function Ki(e){return e[0]}function Er(e){return e[e.length-1]}function Zi(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,a=null;const n=Er(e);for(;s>=0&&(a=e[s],!(n.timestamp-a.timestamp>tn(t)));)s--;if(!a)return{x:0,y:0};const l=sn(n.timestamp-a.timestamp);if(l===0)return{x:0,y:0};const i={x:(n.x-a.x)/l,y:(n.y-a.y)/l};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}const Cr=1e-4,Qi=1-Cr,eo=1+Cr,Tr=.01,to=0-Tr,so=0+Tr;function X(e){return e.max-e.min}function ro(e,t,s){return Math.abs(e-t)<=s}function Wt(e,t,s,a=.5){e.origin=a,e.originPoint=U(t.min,t.max,e.origin),e.scale=X(s)/X(t),e.translate=U(s.min,s.max,e.origin)-e.originPoint,(e.scale>=Qi&&e.scale<=eo||isNaN(e.scale))&&(e.scale=1),(e.translate>=to&&e.translate<=so||isNaN(e.translate))&&(e.translate=0)}function Pe(e,t,s,a){Wt(e.x,t.x,s.x,a?a.originX:void 0),Wt(e.y,t.y,s.y,a?a.originY:void 0)}function qt(e,t,s){e.min=s.min+t.min,e.max=e.min+X(t)}function ao(e,t,s){qt(e.x,t.x,s.x),qt(e.y,t.y,s.y)}function Yt(e,t,s){e.min=t.min-s.min,e.max=e.min+X(t)}function Ee(e,t,s){Yt(e.x,t.x,s.x),Yt(e.y,t.y,s.y)}function no(e,{min:t,max:s},a){return t!==void 0&&e<t?e=a?U(t,e,a.min):Math.max(e,t):s!==void 0&&e>s&&(e=a?U(s,e,a.max):Math.min(e,s)),e}function Xt(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function io(e,{top:t,left:s,bottom:a,right:n}){return{x:Xt(e.x,s,n),y:Xt(e.y,t,a)}}function Jt(e,t){let s=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,a]=[a,s]),{min:s,max:a}}function oo(e,t){return{x:Jt(e.x,t.x),y:Jt(e.y,t.y)}}function lo(e,t){let s=.5;const a=X(e),n=X(t);return n>a?s=ht(t.min,t.max-a,e.min):a>n&&(s=ht(e.min,e.max-n,t.min)),Ks(0,1,s)}function co(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const pt=.35;function uo(e=pt){return e===!1?e=0:e===!0&&(e=pt),{x:Kt(e,"left","right"),y:Kt(e,"top","bottom")}}function Kt(e,t,s){return{min:Zt(e,t),max:Zt(e,s)}}function Zt(e,t){return typeof e=="number"?e:e[t]||0}function K(e){return[e("x"),e("y")]}const Ar=({current:e})=>e?e.ownerDocument.defaultView:null,mo=new WeakMap;class ho{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=O(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const n=u=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(Re(u).point)},l=(u,m)=>{const{drag:h,dragPropagation:p,onDragStart:x}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Xi(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),K(v=>{let g=this.getAxisMotionValue(v).get()||0;if(ze.test(g)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[v];w&&(g=X(w)*(parseFloat(g)/100))}}this.originPoint[v]=g}),x&&G.postRender(()=>x(u,m)),Dt(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},i=(u,m)=>{const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:x,onDrag:y}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=m;if(p&&this.currentDirection===null){this.currentDirection=fo(v),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",m.point,v),this.updateAxis("y",m.point,v),this.visualElement.render(),y&&y(u,m)},o=(u,m)=>this.stop(u,m),c=()=>K(u=>{var m;return this.getAnimationState(u)==="paused"&&((m=this.getAxisMotionValue(u).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Pr(t,{onSessionStart:n,onStart:l,onMove:i,onSessionEnd:o,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:Ar(this.visualElement)})}stop(t,s){const a=this.isDragging;if(this.cancel(),!a)return;const{velocity:n}=s;this.startAnimation(n);const{onDragEnd:l}=this.getProps();l&&G.postRender(()=>l(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,a){const{drag:n}=this.getProps();if(!a||!Oe(t,n,this.currentDirection))return;const l=this.getAxisMotionValue(t);let i=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(i=no(i,this.constraints[t],this.elastic[t])),l.set(i)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:a}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,l=this.constraints;s&&ge(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&n?this.constraints=io(n.layoutBox,s):this.constraints=!1,this.elastic=uo(a),l!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&K(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=co(n.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!ge(t))return!1;const a=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const l=rn(a,n.root,this.visualElement.getTransformPagePoint());let i=oo(n.layout.layoutBox,l);if(s){const o=s(an(i));this.hasMutatedConstraints=!!o,o&&(i=nn(o))}return i}startAnimation(t){const{drag:s,dragMomentum:a,dragElastic:n,dragTransition:l,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},d=K(u=>{if(!Oe(u,s,this.currentDirection))return;let m=c&&c[u]||{};i&&(m={min:0,max:0});const h=n?200:1e6,p=n?40:1e7,x={type:"inertia",velocity:a?t[u]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...l,...m};return this.startAxisValueAnimation(u,x)});return Promise.all(d).then(o)}startAxisValueAnimation(t,s){const a=this.getAxisMotionValue(t);return Dt(this.visualElement,t),a.start(on(t,a,0,s,this.visualElement,!1))}stopAnimation(){K(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){K(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),n=a[s];return n||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){K(s=>{const{drag:a}=this.getProps();if(!Oe(s,a,this.currentDirection))return;const{projection:n}=this.visualElement,l=this.getAxisMotionValue(s);if(n&&n.layout){const{min:i,max:o}=n.layout.layoutBox[s];l.set(t[s]-U(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:a}=this.visualElement;if(!ge(s)||!a||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};K(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();n[i]=lo({min:c,max:c},this.constraints[i])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),K(i=>{if(!Oe(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];o.set(U(c,d,n[i]))})}addListeners(){if(!this.visualElement.current)return;mo.set(this.visualElement,this);const t=this.visualElement.current,s=ke(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),a=()=>{const{dragConstraints:c}=this.getProps();ge(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,l=n.addEventListener("measure",a);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),G.read(a);const i=Ce(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(K(u=>{const m=this.getAxisMotionValue(u);m&&(this.originPoint[u]+=c[u].translate,m.set(m.get()+c[u].translate))}),this.visualElement.render())}));return()=>{i(),s(),l(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:a=!1,dragPropagation:n=!1,dragConstraints:l=!1,dragElastic:i=pt,dragMomentum:o=!0}=t;return{...t,drag:s,dragDirectionLock:a,dragPropagation:n,dragConstraints:l,dragElastic:i,dragMomentum:o}}}function Oe(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function fo(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class po extends de{constructor(t){super(t),this.removeGroupControls=ve,this.removeListeners=ve,this.controls=new ho(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ve}unmount(){this.removeGroupControls(),this.removeListeners()}}const Qt=e=>(t,s)=>{e&&G.postRender(()=>e(t,s))};class go extends de{constructor(){super(...arguments),this.removePointerDownListener=ve}onPointerDown(t){this.session=new Pr(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Ar(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:a,onPanEnd:n}=this.node.getProps();return{onSessionStart:Qt(t),onStart:Qt(s),onMove:a,onEnd:(l,i)=>{delete this.session,n&&G.postRender(()=>n(l,i))}}}mount(){this.removePointerDownListener=ke(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ue={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function es(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const je={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Zs.test(e))e=parseFloat(e);else return e;const s=es(e,t.target.x),a=es(e,t.target.y);return`${s}% ${a}%`}},xo={correct:(e,{treeScale:t,projectionDelta:s})=>{const a=e,n=It.parse(e);if(n.length>5)return a;const l=It.createTransformer(e),i=typeof n[0]!="number"?1:0,o=s.x.scale*t.x,c=s.y.scale*t.y;n[0+i]/=o,n[1+i]/=c;const d=U(o,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=d),typeof n[3+i]=="number"&&(n[3+i]/=d),l(n)}};class vo extends f.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:a,layoutId:n}=this.props,{projection:l}=t;ln(yo),l&&(s.group&&s.group.add(l),a&&a.register&&n&&a.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Ue.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:a,drag:n,isPresent:l}=this.props,i=a.projection;return i&&(i.isPresent=l,n||t.layoutDependency!==s||s===void 0?i.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?i.promote():i.relegate()||G.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),_t.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:a}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(n),a&&a.deregister&&a.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Rr(e){const[t,s]=gr(),a=f.useContext(jt);return r.jsx(vo,{...e,layoutGroup:a,switchLayoutGroup:f.useContext(br),isPresent:t,safeToRemove:s})}const yo={borderRadius:{...je,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:je,borderTopRightRadius:je,borderBottomLeftRadius:je,borderBottomRightRadius:je,boxShadow:xo},bo=(e,t)=>e.depth-t.depth;class wo{constructor(){this.children=[],this.isDirty=!1}add(t){Qs(this.children,t),this.isDirty=!0}remove(t){er(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(bo),this.isDirty=!1,this.children.forEach(t)}}const Dr=["TopLeft","TopRight","BottomLeft","BottomRight"],jo=Dr.length,ts=e=>typeof e=="string"?parseFloat(e):e,ss=e=>typeof e=="number"||Zs.test(e);function So(e,t,s,a,n,l){n?(e.opacity=U(0,s.opacity!==void 0?s.opacity:1,No(a)),e.opacityExit=U(t.opacity!==void 0?t.opacity:1,0,_o(a))):l&&(e.opacity=U(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,a));for(let i=0;i<jo;i++){const o=`border${Dr[i]}Radius`;let c=rs(t,o),d=rs(s,o);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||ss(c)===ss(d)?(e[o]=Math.max(U(ts(c),ts(d),a),0),(ze.test(d)||ze.test(c))&&(e[o]+="%")):e[o]=d}(t.rotate||s.rotate)&&(e.rotate=U(t.rotate||0,s.rotate||0,a))}function rs(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const No=Ir(0,.5,dn),_o=Ir(.5,.95,ve);function Ir(e,t,s){return a=>a<e?0:a>t?1:s(ht(e,t,a))}function as(e,t){e.min=t.min,e.max=t.max}function J(e,t){as(e.x,t.x),as(e.y,t.y)}function ns(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function is(e,t,s,a,n){return e-=t,e=Mt(e,1/s,a),n!==void 0&&(e=Mt(e,1/n,a)),e}function ko(e,t=0,s=1,a=.5,n,l=e,i=e){if(ze.test(t)&&(t=parseFloat(t),t=U(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=U(l.min,l.max,a);e===l&&(o-=t),e.min=is(e.min,t,s,o,n),e.max=is(e.max,t,s,o,n)}function os(e,t,[s,a,n],l,i){ko(e,t[s],t[a],t[n],t.scale,l,i)}const Po=["x","scaleX","originX"],Eo=["y","scaleY","originY"];function ls(e,t,s,a){os(e.x,t,Po,s?s.x:void 0,a?a.x:void 0),os(e.y,t,Eo,s?s.y:void 0,a?a.y:void 0)}function ds(e){return e.translate===0&&e.scale===1}function Mr(e){return ds(e.x)&&ds(e.y)}function cs(e,t){return e.min===t.min&&e.max===t.max}function Co(e,t){return cs(e.x,t.x)&&cs(e.y,t.y)}function us(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Lr(e,t){return us(e.x,t.x)&&us(e.y,t.y)}function ms(e){return X(e.x)/X(e.y)}function hs(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class To{constructor(){this.members=[]}add(t){Qs(this.members,t),t.scheduleRender()}remove(t){if(er(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(n=>t===n);if(s===0)return!1;let a;for(let n=s;n>=0;n--){const l=this.members[n];if(l.isPresent!==!1){a=l;break}}return a?(this.promote(a),!0):!1}promote(t,s){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,s&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:a}=t;s.onExitComplete&&s.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ao(e,t,s){let a="";const n=e.x.translate/t.x,l=e.y.translate/t.y,i=s?.z||0;if((n||l||i)&&(a=`translate3d(${n}px, ${l}px, ${i}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),s){const{transformPerspective:d,rotate:u,rotateX:m,rotateY:h,skewX:p,skewY:x}=s;d&&(a=`perspective(${d}px) ${a}`),u&&(a+=`rotate(${u}deg) `),m&&(a+=`rotateX(${m}deg) `),h&&(a+=`rotateY(${h}deg) `),p&&(a+=`skewX(${p}deg) `),x&&(a+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(a+=`scale(${o}, ${c})`),a||"none"}const ue={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Ne=typeof window<"u"&&window.MotionDebug!==void 0,st=["","X","Y","Z"],Ro={visibility:"hidden"},fs=1e3;let Do=0;function rt(e,t,s,a){const{latestValues:n}=t;n[e]&&(s[e]=n[e],t.setStaticValue(e,0),a&&(a[e]=0))}function Or(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const s=yn(t);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:n,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(s,"transform",G,!(n||l))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&Or(a)}function Vr({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:a,resetTransform:n}){return class{constructor(i={},o=t?.()){this.id=Do++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ne&&(ue.totalNodes=ue.resolvedTargetDeltas=ue.recalculatedProjection=0),this.nodes.forEach(Lo),this.nodes.forEach(zo),this.nodes.forEach(Fo),this.nodes.forEach(Oo),Ne&&window.MotionDebug.record(ue)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new wo)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new cn),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=un(i),this.instance=i;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(d||c)&&(this.isLayoutDirty=!0),e){let m;const h=()=>this.root.updateBlockedByResize=!1;e(i,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=mn(h,250),Ue.hasAnimatedSinceResize&&(Ue.hasAnimatedSinceResize=!1,this.nodes.forEach(gs))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:h,hasRelativeTargetChanged:p,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||u.getDefaultTransition()||qo,{onLayoutAnimationStart:v,onLayoutAnimationComplete:g}=u.getProps(),b=!this.targetLayout||!Lr(this.targetLayout,x)||p,w=!h&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,w);const k={...hn(y,"layout"),onPlay:v,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else h||gs(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,mt(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach($o),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Or(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const m=this.path[u];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ps);return}this.isUpdating||this.nodes.forEach(Uo),this.isUpdating=!1,this.nodes.forEach(Bo),this.nodes.forEach(Io),this.nodes.forEach(Mo),this.clearAllSnapshots();const o=fn.now();Y.delta=Ks(0,1e3/60,o-Y.timestamp),Y.timestamp=o,Y.isProcessing=!0,qe.update.process(Y),qe.preRender.process(Y),qe.render.process(Y),Y.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,_t.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Vo),this.sharedNodes.forEach(Ho)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,G.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){G.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=O(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o){const c=a(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Mr(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;i&&(o||fe(this.latestValues)||u)&&(n(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),Yo(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:o}=this.options;if(!o)return O();const c=o.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(Xo))){const{scroll:u}=this.root;u&&(De(c.x,u.offset.x),De(c.y,u.offset.y))}return c}removeElementScroll(i){var o;const c=O();if(J(c,i),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return c;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:m,options:h}=u;u!==this.root&&m&&h.layoutScroll&&(m.wasRoot&&J(c,i),De(c.x,m.offset.x),De(c.y,m.offset.y))}return c}applyTransform(i,o=!1){const c=O();J(c,i);for(let d=0;d<this.path.length;d++){const u=this.path[d];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ie(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),fe(u.latestValues)&&Ie(c,u.latestValues)}return fe(this.latestValues)&&Ie(c,this.latestValues),c}removeTransform(i){const o=O();J(o,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!fe(d.latestValues))continue;Lt(d.latestValues)&&d.updateSnapshot();const u=O(),m=d.measurePageBox();J(u,m),ls(o,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return fe(this.latestValues)&&ls(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Y.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var o;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(i||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:h}=this.options;if(!(!this.layout||!(m||h))){if(this.resolvedRelativeTargetAt=Y.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=O(),this.relativeTargetOrigin=O(),Ee(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),J(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=O(),this.targetWithTransforms=O()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ao(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):J(this.target,this.layout.layoutBox),pn(this.target,this.targetDelta)):J(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=O(),this.relativeTargetOrigin=O(),Ee(this.relativeTargetOrigin,this.target,p.target),J(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ne&&ue.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Lt(this.parent.latestValues)||gn(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Y.timestamp&&(d=!1),d)return;const{layout:u,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||m))return;J(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,p=this.treeScale.y;xn(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=O());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ns(this.prevProjectionDelta.x,this.projectionDelta.x),ns(this.prevProjectionDelta.y,this.projectionDelta.y)),Pe(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==p||!hs(this.projectionDelta.x,this.prevProjectionDelta.x)||!hs(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Ne&&ue.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=pe(),this.projectionDelta=pe(),this.projectionDeltaWithTransform=pe()}setAnimationOrigin(i,o=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},m=pe();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=O(),p=c?c.source:void 0,x=this.layout?this.layout.source:void 0,y=p!==x,v=this.getStack(),g=!v||v.members.length<=1,b=!!(y&&!g&&this.options.crossfade===!0&&!this.path.some(Wo));this.animationProgress=0;let w;this.mixTargetDelta=k=>{const C=k/1e3;xs(m.x,i.x,C),xs(m.y,i.y,C),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ee(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Go(this.relativeTarget,this.relativeTargetOrigin,h,C),w&&Co(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=O()),J(w,this.relativeTarget)),y&&(this.animationValues=u,So(u,d,this.latestValues,C,b,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(mt(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=G.update(()=>{Ue.hasAnimatedSinceResize=!0,this.currentAnimation=vn(0,fs,{...i,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fs),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:d,latestValues:u}=i;if(!(!o||!c||!d)){if(this!==i&&this.layout&&d&&Ur(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||O();const m=X(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+m;const h=X(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}J(o,c),Ie(o,u),Pe(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new To),this.sharedNodes.get(i).add(o);const d=o.options.initialPromotionConfig;o.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:o}=this.options;return o?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:o}=this.options;return o?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const d={};c.z&&rt("z",i,d,this.animationValues);for(let u=0;u<st.length;u++)rt(`rotate${st[u]}`,i,d,this.animationValues),rt(`skew${st[u]}`,i,d,this.animationValues);i.render();for(const u in d)i.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);i.scheduleRender()}getProjectionStyles(i){var o,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Ro;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Ve(i?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const y={};return this.options.layoutId&&(y.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,y.pointerEvents=Ve(i?.pointerEvents)||""),this.hasProjected&&!fe(this.latestValues)&&(y.transform=u?u({},""):"none",this.hasProjected=!1),y}const h=m.animationValues||m.latestValues;this.applyTransformsToTarget(),d.transform=Ao(this.projectionDeltaWithTransform,this.treeScale,h),u&&(d.transform=u(h,d.transform));const{x:p,y:x}=this.projectionDelta;d.transformOrigin=`${p.origin*100}% ${x.origin*100}% 0`,m.animationValues?d.opacity=m===this?(c=(o=h.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:d.opacity=m===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const y in Ot){if(h[y]===void 0)continue;const{correct:v,applyTo:g}=Ot[y],b=d.transform==="none"?h[y]:v(h[y],m);if(g){const w=g.length;for(let k=0;k<w;k++)d[g[k]]=b}else d[y]=b}return this.options.layoutId&&(d.pointerEvents=m===this?Ve(i?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(ps),this.root.sharedNodes.clear()}}}function Io(e){e.updateLayout()}function Mo(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:n}=e.layout,{animationType:l}=e.options,i=s.source!==e.layout.source;l==="size"?K(m=>{const h=i?s.measuredBox[m]:s.layoutBox[m],p=X(h);h.min=a[m].min,h.max=h.min+p}):Ur(l,s.layoutBox,a)&&K(m=>{const h=i?s.measuredBox[m]:s.layoutBox[m],p=X(a[m]);h.max=h.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[m].max=e.relativeTarget[m].min+p)});const o=pe();Pe(o,a,s.layoutBox);const c=pe();i?Pe(c,e.applyTransform(n,!0),s.measuredBox):Pe(c,a,s.layoutBox);const d=!Mr(o);let u=!1;if(!e.resumeFrom){const m=e.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:h,layout:p}=m;if(h&&p){const x=O();Ee(x,s.layoutBox,h.layoutBox);const y=O();Ee(y,a,p.layoutBox),Lr(x,y)||(u=!0),m.options.layoutRoot&&(e.relativeTarget=y,e.relativeTargetOrigin=x,e.relativeParent=m)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:c,layoutDelta:o,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function Lo(e){Ne&&ue.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Oo(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Vo(e){e.clearSnapshot()}function ps(e){e.clearMeasurements()}function Uo(e){e.isLayoutDirty=!1}function Bo(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function gs(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function zo(e){e.resolveTargetDelta()}function Fo(e){e.calcProjection()}function $o(e){e.resetSkewAndRotation()}function Ho(e){e.removeLeadSnapshot()}function xs(e,t,s){e.translate=U(t.translate,0,s),e.scale=U(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function vs(e,t,s,a){e.min=U(t.min,s.min,a),e.max=U(t.max,s.max,a)}function Go(e,t,s,a){vs(e.x,t.x,s.x,a),vs(e.y,t.y,s.y,a)}function Wo(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const qo={duration:.45,ease:[.4,0,.1,1]},ys=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),bs=ys("applewebkit/")&&!ys("chrome/")?Math.round:ve;function ws(e){e.min=bs(e.min),e.max=bs(e.max)}function Yo(e){ws(e.x),ws(e.y)}function Ur(e,t,s){return e==="position"||e==="preserve-aspect"&&!ro(ms(t),ms(s),.2)}function Xo(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const Jo=Vr({attachResizeListener:(e,t)=>Ce(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),at={current:void 0},Br=Vr({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!at.current){const e=new Jo({});e.mount(window),e.setOptions({layoutScroll:!0}),at.current=e}return at.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Ko={pan:{Feature:go},drag:{Feature:po,ProjectionNode:Br,MeasureLayout:Rr}};function zr(e,t){const s=bn(e),a=new AbortController,n={passive:!0,...t,signal:a.signal};return[s,n,()=>a.abort()]}function js(e){return t=>{t.pointerType==="touch"||tr()||e(t)}}function Zo(e,t,s={}){const[a,n,l]=zr(e,s),i=js(o=>{const{target:c}=o,d=t(o);if(typeof d!="function"||!c)return;const u=js(m=>{d(m),c.removeEventListener("pointerleave",u)});c.addEventListener("pointerleave",u,n)});return a.forEach(o=>{o.addEventListener("pointerenter",i,n)}),l}function Ss(e,t,s){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",s==="Start");const n="onHover"+s,l=a[n];l&&G.postRender(()=>l(t,Re(t)))}class Qo extends de{mount(){const{current:t}=this.node;t&&(this.unmount=Zo(t,s=>(Ss(this.node,s,"Start"),a=>Ss(this.node,a,"End"))))}unmount(){}}class el extends de{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Js(Ce(this.node.current,"focus",()=>this.onFocus()),Ce(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const Fr=(e,t)=>t?e===t?!0:Fr(e,t.parentElement):!1,tl=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function sl(e){return tl.has(e.tagName)||e.tabIndex!==-1}const _e=new WeakSet;function Ns(e){return t=>{t.key==="Enter"&&e(t)}}function nt(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const rl=(e,t)=>{const s=e.currentTarget;if(!s)return;const a=Ns(()=>{if(_e.has(s))return;nt(s,"down");const n=Ns(()=>{nt(s,"up")}),l=()=>nt(s,"cancel");s.addEventListener("keyup",n,t),s.addEventListener("blur",l,t)});s.addEventListener("keydown",a,t),s.addEventListener("blur",()=>s.removeEventListener("keydown",a),t)};function _s(e){return Et(e)&&!tr()}function al(e,t,s={}){const[a,n,l]=zr(e,s),i=o=>{const c=o.currentTarget;if(!_s(o)||_e.has(c))return;_e.add(c);const d=t(o),u=(p,x)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",h),!(!_s(p)||!_e.has(c))&&(_e.delete(c),typeof d=="function"&&d(p,{success:x}))},m=p=>{u(p,s.useGlobalTarget||Fr(c,p.target))},h=p=>{u(p,!1)};window.addEventListener("pointerup",m,n),window.addEventListener("pointercancel",h,n)};return a.forEach(o=>{!sl(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(s.useGlobalTarget?window:o).addEventListener("pointerdown",i,n),o.addEventListener("focus",d=>rl(d,n),n)}),l}function ks(e,t,s){const{props:a}=e;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",s==="Start");const n="onTap"+(s==="End"?"":s),l=a[n];l&&G.postRender(()=>l(t,Re(t)))}class nl extends de{mount(){const{current:t}=this.node;t&&(this.unmount=al(t,s=>(ks(this.node,s,"Start"),(a,{success:n})=>ks(this.node,a,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const gt=new WeakMap,it=new WeakMap,il=e=>{const t=gt.get(e.target);t&&t(e)},ol=e=>{e.forEach(il)};function ll({root:e,...t}){const s=e||document;it.has(s)||it.set(s,{});const a=it.get(s),n=JSON.stringify(t);return a[n]||(a[n]=new IntersectionObserver(ol,{root:e,...t})),a[n]}function dl(e,t,s){const a=ll(t);return gt.set(e,s),a.observe(e),()=>{gt.delete(e),a.unobserve(e)}}const cl={some:0,all:1};class ul extends de{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:a,amount:n="some",once:l}=t,i={root:s?s.current:void 0,rootMargin:a,threshold:typeof n=="number"?n:cl[n]},o=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,l&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:m}=this.node.getProps(),h=d?u:m;h&&h(c)};return dl(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(ml(t,s))&&this.startObserver()}unmount(){}}function ml({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const hl={inView:{Feature:ul},tap:{Feature:nl},focus:{Feature:el},hover:{Feature:Qo}},fl={layout:{ProjectionNode:Br,MeasureLayout:Rr}},pl=(e,t)=>kt(e)?new wn(t):new jn(t,{allowProjection:e!==f.Fragment}),gl=Mi({...Yi,...hl,...Ko,...fl},pl),xl=hi(gl);function $r({...e}){return r.jsx(Es,{"data-slot":"sheet",...e})}function vl({...e}){return r.jsx(Is,{"data-slot":"sheet-trigger",...e})}function yl({...e}){return r.jsx(Ds,{"data-slot":"sheet-portal",...e})}function bl({className:e,...t}){return r.jsx(xt,{"data-slot":"sheet-overlay",className:A("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function Hr({className:e,children:t,side:s="right",...a}){return r.jsxs(yl,{children:[r.jsx(bl,{}),r.jsxs(Cs,{"data-slot":"sheet-content",className:A("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-2xl transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",s==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l-2 sm:max-w-sm",s==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r-2 sm:max-w-sm",s==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b-2",s==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t-2",e),...a,children:[t,r.jsxs(Ts,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[r.jsx(vt,{className:"size-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Gr({className:e,...t}){return r.jsx("div",{"data-slot":"sheet-header",className:A("flex flex-col gap-1.5 p-4",e),...t})}function Wr({className:e,...t}){return r.jsx(As,{"data-slot":"sheet-title",className:A("text-foreground font-semibold",e),...t})}function wl({className:e,...t}){return r.jsx(Rs,{"data-slot":"sheet-description",className:A("text-muted-foreground text-sm",e),...t})}function jl({className:e,children:t,...s}){return r.jsxs(ma,{"data-slot":"scroll-area",className:A("relative",e),...s,children:[r.jsx(ha,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),r.jsx(Sl,{}),r.jsx(fa,{})]})}function Sl({className:e,orientation:t="vertical",...s}){return r.jsx(pa,{"data-slot":"scroll-area-scrollbar",orientation:t,className:A("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...s,children:r.jsx(ga,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}const Nl={connection_request:ct,connection_accepted:ct,post_reaction:Us,post_comment:Fs,event_reminder:zs,society_invite:Bs,mention:Ca,achievement:Ea},_l={connection_request:"text-primary",connection_accepted:"text-primary",post_reaction:"text-destructive",post_comment:"text-primary",event_reminder:"text-accent-foreground",society_invite:"text-primary",mention:"text-primary",achievement:"text-primary"};function kl({open:e,onOpenChange:t}){const{notifications:s,unreadCount:a,markAsRead:n,markAllAsRead:l,clearNotification:i}=nr();return r.jsx($r,{open:e,onOpenChange:t,children:r.jsxs(Hr,{side:"right",className:"w-full sm:max-w-md p-0",children:[r.jsx(Gr,{className:"p-6 pb-4 border-b border-border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Wr,{children:"Notifications"}),a>0&&r.jsx(pr,{variant:"destructive",className:"rounded-full",children:a})]}),a>0&&r.jsxs(L,{variant:"ghost",size:"sm",onClick:l,className:"text-xs rounded-xl",children:[r.jsx(Tt,{className:"h-3 w-3 mr-1"}),"Mark all read"]})]})}),r.jsx(jl,{className:"h-[calc(100vh-80px)]",children:r.jsx(li,{mode:"popLayout",children:s.length===0?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-accent flex items-center justify-center",children:r.jsx(Tt,{className:"h-8 w-8 text-muted-foreground"})}),r.jsx("p",{className:"text-muted-foreground",children:"No notifications"}),r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"You're all caught up!"})]}):r.jsx("div",{className:"divide-y divide-border",children:s.map(o=>{const c=Nl[o.type],d=_l[o.type];return r.jsx(xl.div,{layout:!0,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:`p-4 hover:bg-accent transition-colors cursor-pointer relative group ${o.read?"":"bg-accent/50"}`,onClick:()=>!o.read&&n(o.id),children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"flex-shrink-0",children:o.avatar?r.jsx(Fe,{className:"w-10 h-10",children:r.jsx($e,{className:"bg-primary text-white",children:o.title[0]})}):r.jsx("div",{className:`w-10 h-10 rounded-full bg-accent flex items-center justify-center ${d}`,children:r.jsx(c,{className:"h-5 w-5"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm mb-1",children:o.title}),r.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:o.message}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:o.timestamp})]}),!o.read&&r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-2 h-2 rounded-full bg-primary"})}),r.jsx(L,{variant:"ghost",size:"icon",onClick:u=>{u.stopPropagation(),i(o.id)},className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 rounded-full",children:r.jsx(vt,{className:"h-3 w-3"})})]})},o.id)})})})})]})})}function Pl({title:e=ae,showSearch:t=!1,darkMode:s,onToggleDarkMode:a,onSearchClick:n}){const[l,i]=f.useState(!1),{unreadCount:o}=nr(),{navigate:c}=Te(),{user:d}=he(),u=ri(),m=e===ae;return r.jsxs("header",{className:"fixed top-0 left-0 right-0 bg-card border-b border-border z-40 backdrop-blur-sm bg-card/95 h-[70px]",children:[r.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-full flex items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[u?r.jsx("button",{onClick:()=>c("home"),className:"rounded-full hover:bg-accent p-1 transition-colors","aria-label":"Go to home",children:r.jsx("span",{className:"text-lg font-bold text-primary font-brand",children:"CampusLoif"})}):r.jsx("button",{onClick:()=>c("profile"),className:"rounded-full hover:bg-accent p-1 transition-colors","aria-label":"Go to profile",children:r.jsxs(Fe,{className:"w-8 h-8 rounded-full",children:[r.jsx(Bt,{src:d?.avatar,alt:d?.name}),r.jsx($e,{className:"rounded-full bg-gradient-to-br from-primary to-purple-600 text-white",children:d?.name?.charAt(0).toUpperCase()||ae.charAt(0)})]})}),r.jsx("h1",{className:`hidden sm:block text-xl ${m?"font-brand":"font-semibold"} text-foreground`,children:e})]}),t&&r.jsx("div",{className:"flex-1 max-w-md hidden md:block",children:r.jsxs("button",{onClick:n,className:"w-full text-left relative",children:[r.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx("div",{className:"w-full pl-10 pr-4 py-2 bg-input-background rounded-full border border-border hover:border-primary transition-colors cursor-pointer",children:r.jsx("span",{className:"text-sm text-muted-foreground",children:"Search students, societies, events..."})})]})}),r.jsxs("div",{className:"flex items-center gap-1",children:[t&&r.jsx(L,{variant:"ghost",size:"icon",className:"rounded-full md:hidden hover:bg-accent",onClick:n,children:r.jsx(At,{className:"h-5 w-5"})}),r.jsxs(L,{variant:"ghost",size:"icon",className:"rounded-full relative hover:bg-accent",onClick:()=>i(!0),children:[r.jsx(Ta,{className:"h-5 w-5"}),o>0&&r.jsx(pr,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs rounded-full",children:o>9?"9+":o})]}),u?r.jsx("button",{onClick:()=>c("profile"),className:"rounded-full hover:bg-accent p-1 transition-colors","aria-label":"Go to profile",children:r.jsxs(Fe,{className:"w-8 h-8 rounded-full",children:[r.jsx(Bt,{src:d?.avatar,alt:d?.name}),r.jsx($e,{className:"rounded-full bg-gradient-to-br from-primary to-purple-600 text-white",children:d?.name?.charAt(0).toUpperCase()||ae.charAt(0)})]})}):r.jsx(L,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-accent",onClick:a,children:s?r.jsx(Aa,{className:"h-5 w-5"}):r.jsx(Ra,{className:"h-5 w-5"})})]})]}),r.jsx(kl,{open:l,onOpenChange:i})]})}function El(){const{currentPage:e,navigate:t}=Te(),[s,a]=f.useState(!1),n=[{id:"home",icon:Da,label:"Home"},{id:"connections",icon:ct,label:"Circle"},{id:"societies",icon:Bs,label:"Societies"},{id:"chat",icon:Fs,label:"Chat"}],l=[{id:"events",icon:zs,label:"Events"},{id:"bookmarks",icon:Ma,label:"Bookmarks"},{id:"settings",icon:La,label:"Settings"}],i=o=>{t(o),a(!1)};return r.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border md:hidden z-50","aria-label":"Mobile navigation",children:r.jsxs("div",{className:"flex items-center justify-around px-2 py-2",children:[n.map(o=>{const c=o.icon,d=e===o.id;return r.jsxs("button",{onClick:()=>t(o.id),className:`flex flex-col items-center justify-center gap-1 px-3 py-2 rounded-lg transition-all ${d?"text-primary bg-accent":"text-muted-foreground hover:text-foreground hover:bg-accent/50"}`,"aria-current":d?"page":void 0,"aria-label":o.label,children:[r.jsx(c,{className:"h-5 w-5"}),r.jsx("span",{className:"text-xs font-medium",children:o.label})]},o.id)}),r.jsxs($r,{open:s,onOpenChange:a,children:[r.jsx(vl,{asChild:!0,children:r.jsxs("button",{className:`flex flex-col items-center justify-center gap-1 px-3 py-2 rounded-lg transition-all ${["events","bookmarks","settings"].includes(e)?"text-primary bg-accent":"text-muted-foreground hover:text-foreground hover:bg-accent/50"}`,"aria-label":"More options",children:[r.jsx(Ia,{className:"h-5 w-5"}),r.jsx("span",{className:"text-xs font-medium",children:"More"})]})}),r.jsxs(Hr,{side:"bottom",className:"rounded-t-2xl",children:[r.jsxs(Gr,{className:"mb-4",children:[r.jsx(Wr,{className:"text-lg font-semibold",children:"More Options"}),r.jsx(wl,{children:"Access additional features and settings"})]}),r.jsx("div",{className:"grid gap-2 pb-6",children:l.map(o=>{const c=o.icon,d=e===o.id;return r.jsxs(L,{variant:d?"default":"ghost",onClick:()=>i(o.id),className:"w-full justify-start gap-3 h-12 rounded-lg font-medium",children:[r.jsx(c,{className:"h-5 w-5"}),r.jsx("span",{children:o.label})]},o.id)})})]})]})]})})}function Cl(){const{currentPage:e,navigate:t}=Te(),s=Object.values(Pn);return r.jsx("nav",{className:"hidden md:block fixed left-0 top-[70px] bottom-0 w-64 border-r border-border bg-card p-4","aria-label":"Main navigation",children:r.jsx("div",{className:"space-y-1",children:s.map(a=>r.jsxs("button",{onClick:()=>t(a.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all font-medium ${e===a.id?"bg-primary text-white shadow-sm":"hover:bg-accent text-foreground hover:text-foreground"}`,"aria-current":e===a.id?"page":void 0,children:[r.jsx("span",{className:"text-lg","aria-hidden":"true",children:a.icon}),r.jsx("span",{className:"text-sm",children:a.label})]},a.id))})})}const Se=e=>new Promise(t=>setTimeout(t,e)),ot={like:0,love:0,celebrate:0,support:0,insightful:0};class Tl{async createPost(t){return await Se(800),{id:`post-${Date.now()}`,authorId:"user-123",author:"You",department:"Computer Science",batch:"Fall 2023",timeAgo:"Just now",content:t.content,image:t.image,reactions:{...ot},totalReactions:0,comments:0,liked:!1}}async getPosts(t=1,s=10){return await Se(600),[{id:"1",authorId:"user-456",author:"Sarah Johnson",department:"Computer Science",batch:"Fall 2023",timeAgo:"2h ago",content:"Just finished my Machine Learning project! The results are amazing. Can't wait to present it next week. Anyone else working on AI projects this semester?",image:"https://images.unsplash.com/photo-1582192904915-d89c7250b235?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx0ZWNoJTIwY29uZmVyZW5jZSUyMHByZXNlbnRhdGlvbnxlbnwxfHx8fDE3NTk3MTI0OTR8MA&ixlib=rb-4.1.0&q=80&w=1080&utm_source=figma&utm_medium=referral",reactions:{...ot,like:24},totalReactions:24,comments:8,liked:!0},{id:"2",authorId:"user-789",author:"Michael Chen",department:"Business Administration",batch:"Spring 2024",timeAgo:"4h ago",content:"Reminder: Marketing Club meets tomorrow at 5 PM in Building A, Room 203. We'll be discussing the upcoming campus event. See you there! 🚀",reactions:{...ot,like:15},totalReactions:15,comments:5,liked:!1}]}async likePost(t){await Se(300)}async unlikePost(t){await Se(300)}async deletePost(t){await Se(500)}}const Al=new Tl;function Rl({open:e,onOpenChange:t,onPostCreated:s}){const[a,n]=f.useState(""),[l,i]=f.useState("text"),[o,c]=f.useState(!1),[d,u]=f.useState(""),{user:m}=he(),h=Ae(),p=async()=>{const x=z.postContent(a);if(!x.valid){u(x.message||"Invalid post content");return}u(""),c(!0);try{await Al.createPost({content:a}),h.success(h.messages.success.POST_CREATED),n(""),u(""),t(!1),s?.()}catch{u("Failed to create post. Please try again.")}finally{c(!1)}};return r.jsx(lr,{open:e,onOpenChange:t,children:r.jsxs(cr,{className:"sm:max-w-[600px] p-0",children:[r.jsxs(ur,{className:"p-6 pb-4",children:[r.jsx(mr,{children:"Create Post"}),r.jsx(hr,{className:"sr-only",children:"Share your thoughts, photos, or create a poll with your university community"})]}),r.jsxs("div",{className:"px-6 pb-6",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[r.jsx(Fe,{className:"w-10 h-10",children:r.jsx($e,{className:"bg-primary text-white",children:"Y"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm",children:m?.name||"You"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:m?.department&&m?.batch?`${m.department} • ${m.batch}`:""})]})]}),r.jsx(fr,{placeholder:"What's on your mind?",value:a,onChange:x=>{n(x.target.value),d&&u("")},className:"min-h-[120px] mb-4 rounded-xl resize-none"}),d&&r.jsx("div",{className:"mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:r.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 flex items-center gap-2 font-semibold",children:[r.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),d]})}),l==="poll"&&r.jsxs("div",{className:"space-y-3 mb-4",children:[r.jsx("input",{type:"text",placeholder:"Poll option 1",className:"w-full px-4 py-2 bg-input-background rounded-xl border border-border focus:outline-none focus:ring-2 focus:ring-ring"}),r.jsx("input",{type:"text",placeholder:"Poll option 2",className:"w-full px-4 py-2 bg-input-background rounded-xl border border-border focus:outline-none focus:ring-2 focus:ring-ring"}),r.jsx(L,{variant:"outline",className:"w-full rounded-xl",children:"Add Option"})]}),r.jsxs("div",{className:"flex items-center gap-2 mb-6 p-3 border border-border rounded-xl",children:[r.jsx("span",{className:"text-sm",children:"Add to post:"}),r.jsx(L,{variant:"ghost",size:"sm",className:"rounded-xl gap-2",onClick:()=>i("text"),children:r.jsx(Oa,{className:"h-4 w-4 text-green-600"})}),r.jsx(L,{variant:"ghost",size:"sm",className:"rounded-xl gap-2",onClick:()=>i(l==="poll"?"text":"poll"),children:r.jsx(Va,{className:`h-4 w-4 ${l==="poll"?"text-primary":"text-blue-600"}`})}),r.jsx(L,{variant:"ghost",size:"sm",className:"rounded-xl gap-2",children:r.jsx(Ua,{className:"h-4 w-4 text-yellow-600"})})]}),r.jsx(L,{onClick:p,disabled:!a.trim()||o,className:"w-full rounded-xl h-11",children:o?r.jsxs(r.Fragment,{children:[r.jsx(Ls,{className:"w-4 h-4 mr-2 animate-spin"}),"Posting..."]}):"Post"})]})]})})}const Dl=f.lazy(()=>ee(()=>import("./HomePage-BhmACnKF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(e=>({default:e.HomePage}))),Il=f.lazy(()=>ee(()=>import("./ProfilePage-BYukCCK3.js"),__vite__mapDeps([8,1,2,9,4,3,6,7])).then(e=>({default:e.ProfilePage}))),Ml=f.lazy(()=>ee(()=>import("./ConnectionsPage-Dr5coc1q.js"),__vite__mapDeps([10,1,2,9,3,6,7])).then(e=>({default:e.ConnectionsPage}))),Ll=f.lazy(()=>ee(()=>import("./SocietiesPage-DaAjOMou.js"),__vite__mapDeps([11,1,2,3,6,7])).then(e=>({default:e.SocietiesPage}))),Ol=f.lazy(()=>ee(()=>import("./SocietyRoomPage-CDFGi7t4.js"),__vite__mapDeps([12,1,2,9,3,6,7])).then(e=>({default:e.SocietyRoomPage}))),Vl=f.lazy(()=>ee(()=>import("./EventsPage-DdklcISJ.js"),__vite__mapDeps([13,1,2,9,3,6,7])).then(e=>({default:e.EventsPage}))),Ul=f.lazy(()=>ee(()=>import("./ChatPage-ea9-m49N.js"),__vite__mapDeps([14,1,2,3,15,16,17,6,7])).then(e=>({default:e.ChatPage}))),Bl=f.lazy(()=>ee(()=>import("./BookmarksPage-CUU3HAJx.js"),__vite__mapDeps([18,1,2,4,3,9,6,7])).then(e=>({default:e.BookmarksPage}))),zl=f.lazy(()=>ee(()=>import("./AdvancedSearchPage-B3WsnKx6.js"),__vite__mapDeps([19,1,2,9,5,4,3,6,7])).then(e=>({default:e.AdvancedSearchPage}))),Fl=f.lazy(()=>ee(()=>import("./SettingsPage-BWlN7tjh.js"),__vite__mapDeps([20,1,2,15,5,3,6,7])).then(e=>({default:e.SettingsPage})));function $l(){const{currentPage:e,darkMode:t,toggleDarkMode:s,navigate:a}=Te(),[n,l]=f.useState(!1);return r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsx(Pl,{title:ae,showSearch:e==="home",darkMode:t,onToggleDarkMode:s,onSearchClick:()=>a("search")}),r.jsx(Cl,{}),r.jsx("main",{className:"md:ml-64 pt-[70px] pb-16 md:pb-0",children:r.jsxs(f.Suspense,{fallback:r.jsx(me,{fullScreen:!0,size:"lg",text:"Loading page..."}),children:[e==="home"&&r.jsx(Dl,{onOpenCreatePost:()=>l(!0)}),e==="profile"&&r.jsx(Il,{}),e==="connections"&&r.jsx(Ml,{}),e==="societies"&&r.jsx(Ll,{}),e==="society-room"&&r.jsx(Ol,{}),e==="events"&&r.jsx(Vl,{}),e==="chat"&&r.jsx(Ul,{}),e==="bookmarks"&&r.jsx(Bl,{}),e==="search"&&r.jsx(zl,{}),e==="settings"&&r.jsx(Fl,{})]})}),r.jsx(El,{}),e==="home"&&r.jsx(L,{size:"icon",onClick:()=>l(!0),className:"fixed bottom-[88px] right-6 md:bottom-6 md:right-6 w-14 h-14 rounded-full shadow-lg shadow-primary/30 z-40","aria-label":"Create new post",children:r.jsx(Ba,{className:"h-6 w-6"})}),r.jsx(Rl,{open:n,onOpenChange:l})]})}function Hl(){const{isAuthenticated:e,isEmailVerified:t,isOnboarded:s,isLoading:a}=he(),{isLoading:n}=Te();let l=!1;try{const c=localStorage.getItem("uniconnect_user_data")||sessionStorage.getItem("uniconnect_user_data"),d=localStorage.getItem("uniconnect_email_verified");l=!!c&&d==="false"}catch{}if(a)return r.jsx(me,{fullScreen:!0,size:"lg",text:"Loading..."});const i=typeof window<"u"&&window.location.pathname==="/signup",o=typeof window<"u"&&window.location.pathname==="/reset";return i?r.jsx(Kn,{}):o?r.jsx(ti,{}):!e&&l?r.jsx(Ut,{}):e?t?s?r.jsxs(r.Fragment,{children:[n&&r.jsx(me,{fullScreen:!0,size:"lg"}),r.jsx($l,{})]}):r.jsx(ei,{}):r.jsx(Ut,{}):r.jsx(Xn,{})}const Gl=({...e})=>{const s=typeof document<"u"&&document.documentElement.classList.contains("dark")?"dark":"light";return r.jsx(za,{theme:e.theme??s,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Wl(){const[e,t]=f.useState(null),[s,a]=f.useState(!1);return f.useEffect(()=>{},[]),!e||!s?r.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-4 left-4 bg-primary text-primary-foreground px-3 py-2 rounded-lg text-xs font-medium shadow-lg z-50",children:"📊 Perf"}):r.jsxs("div",{className:"fixed bottom-4 left-4 bg-card border border-border rounded-lg p-4 shadow-lg z-50 max-w-sm",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h3",{className:"text-sm font-semibold",children:"Performance Metrics"}),r.jsx("button",{onClick:()=>a(!1),className:"text-muted-foreground hover:text-foreground",children:"×"})]}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Load Time:"}),r.jsxs("span",{className:e.loadTime>1e3?"text-destructive":"text-green-600",children:[e.loadTime.toFixed(0),"ms"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"FCP:"}),r.jsxs("span",{className:e.firstContentfulPaint>1500?"text-destructive":"text-green-600",children:[e.firstContentfulPaint.toFixed(0),"ms"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"LCP:"}),r.jsxs("span",{className:e.largestContentfulPaint>2500?"text-destructive":"text-green-600",children:[e.largestContentfulPaint.toFixed(0),"ms"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Bundle Size:"}),r.jsxs("span",{className:e.bundleSize>5e5?"text-destructive":"text-green-600",children:[(e.bundleSize/1024).toFixed(0),"KB"]})]})]})]})}function ql(){return f.useEffect(()=>{const e=l=>{const i=document.createElement("link");i.rel="preload",i.href=l,i.as="image",document.head.appendChild(i)},t=l=>{const i=document.createElement("link");i.rel="preload",i.href=l,i.as="style",document.head.appendChild(i)},s=l=>{const i=document.createElement("link");i.rel="modulepreload",i.href=l,document.head.appendChild(i)};t("/assets/index-Co1TnHcw.css"),s("/assets/react-vendor-BWX1YzKK.js"),s("/assets/radix-vendor-0isRFci2.js"),s("/assets/ui-vendor-DodV2HUK.js"),["https://images.unsplash.com/photo-1582192904915-d89c7250b235?w=800","https://images.unsplash.com/photo-1632834380561-d1e05839a33a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx1bml2ZXJzaXR5JTIwc3R1ZGVudHMlMjBjYW1wdXN8ZW58MXx8fHwxNzU5Njk0NjMzfDA&ixlib=rb-4.1.0&q=80&w=1080&utm_source=figma&utm_medium=referral"].forEach(e);const n=l=>{const i=document.createElement("link");i.rel="dns-prefetch",i.href=l,document.head.appendChild(i)};n("https://images.unsplash.com"),n("https://fonts.googleapis.com"),n("https://fonts.gstatic.com")},[]),null}function Yl(){return r.jsxs(r.Fragment,{children:[r.jsx(ql,{}),r.jsx(Dn,{children:r.jsx(Vn,{children:r.jsx(Un,{children:r.jsx(zn,{children:r.jsx($n,{children:r.jsxs(Gn,{children:[r.jsx(Hl,{}),r.jsx(Gl,{position:"top-center"}),r.jsx(Wl,{})]})})})})})})]})}Nn.createRoot(document.getElementById("root")).render(r.jsx(Yl,{}));export{Fe as A,L as B,Yn as C,lr as D,ae as E,ie as I,jl as S,fr as T,$e as a,li as b,cr as c,ur as d,mr as e,A as f,Te as g,pr as h,he as i,sd as j,Bt as k,$r as l,xl as m,vl as n,Hr as o,Gr as p,Wr as q,Ye as r,_ as s,Je as t,td as u,Xe as v,Ke as w,Ze as x,ed as y,hr as z};
