import{r as d,j as e}from"./radix-vendor-Dhq5j3y7.js";import{b as y,m as g,B as b,A as E,k as A,a as O}from"./index-YLKFyqAq.js";import{al as N,H as k,am as C,an as L,ao as P,aa as I,X as V,J as B,K as H,e as U,b as w,w as F,v as T,M as D,ap as K}from"./ui-vendor-UqaejbCm.js";const v=[{type:"like",icon:N,label:"Like",color:"#3b82f6"},{type:"love",icon:k,label:"Love",color:"#ef4444"},{type:"celebrate",icon:C,label:"Celebrate",color:"#f59e0b"},{type:"support",icon:L,label:"Support",color:"#8b5cf6"},{type:"insightful",icon:P,label:"Insightful",color:"#10b981"}];function q({onReact:s,currentReaction:c}){const[m,o]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:()=>{s(c||"like")},className:"flex items-center gap-1 px-3 py-1.5 rounded-xl hover:bg-accent transition-colors",children:c?e.jsxs(e.Fragment,{children:[v.find(a=>a.type===c)?.icon&&e.jsx("span",{style:{color:v.find(a=>a.type===c)?.color},children:(()=>{const h=v.find(x=>x.type===c)?.icon;return h?e.jsx(h,{className:"h-4 w-4"}):null})()}),e.jsx("span",{className:"text-sm capitalize",children:c})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"React"})]})}),e.jsx(y,{children:m&&e.jsx(g.div,{initial:{opacity:0,y:10,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.9},transition:{duration:.2},onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),className:"absolute bottom-full left-0 mb-2 bg-card border border-border rounded-2xl shadow-lg p-2 flex gap-2 z-50",children:v.map(a=>e.jsxs(g.button,{whileHover:{scale:1.2,y:-4},whileTap:{scale:.9},onClick:()=>{s(a.type),o(!1)},className:"flex flex-col items-center gap-1 p-2 rounded-xl hover:bg-accent transition-colors",title:a.label,children:[e.jsx(a.icon,{className:"h-6 w-6",style:{color:a.color}}),e.jsx("span",{className:"text-xs",children:a.label})]},a.type))})})]})}function J({images:s,initialIndex:c=0,isOpen:m,onClose:o}){const[a,h]=d.useState(c);d.useEffect(()=>{h(c)},[c]);const x=d.useCallback(()=>{h(t=>(t+1)%s.length)},[s.length]),u=d.useCallback(()=>{h(t=>(t-1+s.length)%s.length)},[s.length]);d.useEffect(()=>{if(!m)return;const t=r=>{r.key==="Escape"&&o(),r.key==="ArrowLeft"&&u(),r.key==="ArrowRight"&&x()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[m,u,x,o]);const p=async()=>{const t=s[a];try{const f=await(await fetch(t)).blob(),j=window.URL.createObjectURL(f),i=document.createElement("a");i.href=j,i.download=`image-${a+1}.jpg`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(j),document.body.removeChild(i)}catch(r){console.error("Download failed:",r)}};return e.jsx(y,{children:m&&e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/95 flex items-center justify-center",onClick:o,children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-10",children:[e.jsxs("div",{className:"text-white",children:[a+1," / ",s.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:t=>{t.stopPropagation(),p()},className:"text-white hover:bg-white/20",children:e.jsx(I,{className:"h-5 w-5"})}),e.jsx(b,{variant:"ghost",size:"icon",onClick:o,className:"text-white hover:bg-white/20",children:e.jsx(V,{className:"h-5 w-5"})})]})]}),e.jsx(g.img,{src:s[a],alt:`Image ${a+1}`,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},className:"max-h-[90vh] max-w-[90vw] object-contain",onClick:t=>t.stopPropagation()},a),s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:t=>{t.stopPropagation(),u()},className:"absolute left-4 text-white hover:bg-white/20 h-12 w-12",children:e.jsx(B,{className:"h-8 w-8"})}),e.jsx(b,{variant:"ghost",size:"icon",onClick:t=>{t.stopPropagation(),x()},className:"absolute right-4 text-white hover:bg-white/20 h-12 w-12",children:e.jsx(H,{className:"h-8 w-8"})})]}),s.length>1&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 p-2 bg-black/50 rounded-xl backdrop-blur-sm",children:s.map((t,r)=>e.jsx("button",{onClick:f=>{f.stopPropagation(),h(r)},className:`w-16 h-16 rounded-lg overflow-hidden border-2 transition-all ${r===a?"border-white scale-110":"border-transparent opacity-60"}`,children:e.jsx("img",{src:t,alt:`Thumbnail ${r+1}`,className:"w-full h-full object-cover"})},r))})]})})}function W({poll:s,className:c=""}){const[m,o]=d.useState([]),[a,h]=d.useState(!1),x=()=>{if(m.length===0){w.error("Please select an option");return}h(!0),w.success("Vote recorded!")},u=t=>{a||(s.allowMultiple?o(r=>r.includes(t)?r.filter(f=>f!==t):[...r,t]):o([t]))},p=t=>s.totalVotes===0?0:Math.round(t.votes/s.totalVotes*100);return e.jsxs("div",{className:`bg-accent/50 rounded-xl p-4 ${c}`,children:[e.jsx("h4",{className:"text-sm mb-3",children:s.question}),e.jsx("div",{className:"space-y-2 mb-3",children:s.options.map(t=>{const r=p(t),f=m.includes(t.id),j=a;return e.jsxs(g.button,{whileHover:a?{}:{scale:1.02},whileTap:a?{}:{scale:.98},onClick:()=>u(t.id),disabled:a,className:`w-full text-left p-3 rounded-xl border transition-all relative overflow-hidden ${f&&!a?"border-primary bg-primary/10":"border-border bg-card"} ${a?"cursor-default":"cursor-pointer hover:border-primary"}`,children:[j&&e.jsx(g.div,{initial:{width:0},animate:{width:`${r}%`},transition:{duration:.5,ease:"easeOut"},className:"absolute inset-y-0 left-0 bg-primary/20"}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[f&&!a&&e.jsx("div",{className:"w-5 h-5 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"h-3 w-3 text-white"})}),e.jsx("span",{className:"text-sm",children:t.text})]}),j&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm",children:[r,"%"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.votes," ",t.votes===1?"vote":"votes",")"]})]})]})]},t.id)})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.totalVotes," ",s.totalVotes===1?"vote":"votes",s.allowMultiple&&" • Multiple choice"]}),e.jsxs("span",{children:["Ends ",s.endsAt]})]}),!a&&m.length>0&&e.jsx(b,{onClick:x,size:"sm",className:"w-full mt-3 rounded-xl",children:"Submit Vote"})]})}function Q({post:s}){const[c,m]=d.useState(s.userReaction),[o,a]=d.useState(s.reactions||{like:0,love:0,celebrate:0,support:0,insightful:0}),[h,x]=d.useState(s.totalReactions||0),[u,p]=d.useState(s.isBookmarked||!1),[t,r]=d.useState(!1),[f,j]=d.useState(0),i=s.images||(s.image?[s.image]:[]),S=n=>{c===n?(a(l=>({...l,[n]:Math.max(0,l[n]-1)})),x(l=>Math.max(0,l-1)),m(void 0)):c?(a(l=>({...l,[c]:Math.max(0,l[c]-1),[n]:l[n]+1})),m(n)):(a(l=>({...l,[n]:l[n]+1})),x(l=>l+1),m(n))},z=()=>{p(!u),w.success(u?"Removed from bookmarks":"Added to bookmarks")},R=Object.entries(o).filter(([n,l])=>l>0).sort((n,l)=>l[1]-n[1]).slice(0,3),$={like:N,love:k,celebrate:C,support:L,insightful:P},M={like:"#3b82f6",love:"#ef4444",celebrate:"#f59e0b",support:"#8b5cf6",insightful:"#10b981"};return e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-lg border border-border shadow-sm hover:shadow-md transition-shadow mb-4",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(E,{className:"w-10 h-10",children:[e.jsx(A,{src:s.avatar}),e.jsx(O,{className:"bg-primary text-white",children:s.author.charAt(0)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:s.author}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"•"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.timeAgo})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.department," • ",s.batch]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:z,className:`rounded-full h-8 w-8 hover:bg-accent ${u?"text-primary":"text-muted-foreground"}`,children:e.jsx(F,{className:`h-4 w-4 ${u?"fill-current":""}`})}),e.jsx(b,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8 hover:bg-accent text-muted-foreground",children:e.jsx(T,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"mb-3 text-sm leading-relaxed text-foreground whitespace-pre-wrap",children:s.content}),s.poll&&e.jsx(W,{poll:s.poll,className:"mb-3"}),i.length>0&&e.jsx("div",{className:`mb-3 rounded-lg overflow-hidden grid gap-1 ${i.length===1?"grid-cols-1":i.length===2?"grid-cols-2":i.length===3?"grid-cols-3":"grid-cols-2"}`,children:i.slice(0,4).map((n,l)=>e.jsxs("div",{className:`relative cursor-pointer overflow-hidden ${i.length===3&&l===0?"col-span-3":""} ${i.length>4&&l===3?"relative":""}`,onClick:()=>{j(l),r(!0)},children:[e.jsx(g.img,{whileHover:{scale:1.02},src:n,alt:`Post image ${l+1}`,className:"w-full h-48 object-cover"}),i.length>4&&l===3&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-2xl font-semibold",children:["+",i.length-4]})})]},l))}),s.attachments&&s.attachments.length>0&&e.jsx("div",{className:"mb-3 space-y-2",children:s.attachments.map(n=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-accent rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-xs text-primary",children:n.type.split("/")[1]?.toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm truncate",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(n.size/1024).toFixed(1)," KB"]})]})]},n.id))}),h>0&&e.jsxs("div",{className:"flex items-center justify-between mb-3 pb-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex -space-x-1",children:R.map(([n])=>{const l=$[n];return e.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center",children:e.jsx(l,{className:"h-3 w-3",style:{color:M[n]}})},n)})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:h})]}),s.comments!==void 0&&s.comments>0&&e.jsxs("span",{className:"text-sm text-muted-foreground hover:underline cursor-pointer",children:[s.comments," comments"]})]}),e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsx(q,{onReact:S,currentReaction:c}),e.jsxs(b,{variant:"ghost",size:"sm",className:"rounded-lg gap-2 flex-1 hover:bg-accent",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Comment"})]}),e.jsxs(b,{variant:"ghost",size:"sm",className:"rounded-lg gap-2 hover:bg-accent",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Share"})]})]})]}),i.length>0&&e.jsx(J,{images:i,initialIndex:f,isOpen:t,onClose:()=>r(!1)})]})}export{Q as P};
